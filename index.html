<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DepoE: EO'nun DÃ¼kkanÄ±</title>
    <style>
        :root {
            --bg-color: #0f0c29;
            --bg-gradient: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
            --text-color: #ffffff;
            --accent-color: #ffd700; /* Gold */
            --danger-color: #ff4b4b;
            --success-color: #00e676;
            --eo-color: #d500f9;
            --black-market-color: #9d00ff;
            --glass-bg: rgba(255, 255, 255, 0.1);
            --glass-border: rgba(255, 255, 255, 0.2);
            --shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.37);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--bg-gradient);
            background-attachment: fixed;
            background-size: cover;
            color: var(--text-color);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* UTILS - GLASSMORPHISM */
        .glass {
            background: var(--glass-bg);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid var(--glass-border);
            border-radius: 16px;
            box-shadow: var(--shadow);
        }

        .hidden { display: none !important; }

        .btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-border);
            color: var(--text-color);
            padding: 12px 24px;
            cursor: pointer;
            font-weight: bold;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            text-transform: uppercase;
            margin: 5px;
            border-radius: 12px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            backdrop-filter: blur(4px);
        }
        .btn:hover {
            background: var(--accent-color);
            color: #000;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.3);
        }
        .btn-danger:hover {
             background: var(--danger-color);
             box-shadow: 0 5px 15px rgba(255, 75, 75, 0.4);
        }
        .btn-purple:hover {
            background: var(--eo-color);
            color: white;
            box-shadow: 0 5px 15px rgba(213, 0, 249, 0.4);
        }

        .btn:disabled {
            border-color: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.3);
            cursor: not-allowed;
            background: rgba(0,0,0,0.2);
            transform: none;
            box-shadow: none;
        }

        /* HEADER */
        header {
            background: rgba(0, 0, 0, 0.3);
            backdrop-filter: blur(15px);
            padding: 15px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid var(--glass-border);
            z-index: 100;
        }
        .stats {
            display: flex;
            gap: 25px;
        }
        .stat-box {
            text-align: right;
        }
        .stat-label {
            color: rgba(255,255,255,0.6);
            font-size: 0.75rem;
            letter-spacing: 1px;
            text-transform: uppercase;
        }
        .money { color: var(--success-color); font-weight: bold; }

        .logo {
            font-weight: 900;
            font-size: 1.8rem;
            background: linear-gradient(to right, #ffd700, #ff8c00);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.3);
        }

        /* MAIN CONTENT AREA */
        main {
            flex: 1;
            padding: 30px;
            overflow-y: auto;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* Changed from center to allow scrolling if needed */
        }

        /* SCREENS */
        .screen {
            width: 100%;
            max-width: 900px;
            text-align: center;
            animation: fadeIn 0.6s cubic-bezier(0.22, 1, 0.36, 1);
            padding: 30px;
            margin-top: 20px;
        }

        /* Glass Panel Container for Screens */
        .screen-glass {
            background: var(--glass-bg);
            backdrop-filter: blur(16px);
            border: 1px solid var(--glass-border);
            border-radius: 24px;
            box-shadow: var(--shadow);
            padding: 40px;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); scale: 0.95; }
            to { opacity: 1; transform: translateY(0); scale: 1; }
        }

        /* STORAGE SELECTION */
        .storage-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        .storage-card {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--glass-border);
            padding: 20px;
            border-radius: 16px;
            transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 200px;
            position: relative;
            overflow: hidden;
        }
        .storage-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.1);
            border-color: var(--accent-color);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
        }
        .storage-card h3 { margin-top: 0; color: var(--accent-color); }

        .storage-card.black-market {
            background: rgba(0, 0, 0, 0.85);
            backdrop-filter: blur(20px);
            border-color: #ff0000;
            color: #e0e0e0;
            font-weight: 800;
            box-shadow: 0 0 20px rgba(139, 0, 0, 0.5);
            animation: pulse-red 2s infinite;
        }
        .storage-card.black-market h3 { color: #ff0000; }
        .storage-card.black-market p { font-weight: 800; }

        .storage-card.black-market .unit-price {
            color: #ff0000 !important;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.8) !important;
        }

        @keyframes pulse-red {
            0% { box-shadow: 0 0 20px #8b0000; }
            50% { box-shadow: 0 0 35px #ff0000; }
            100% { box-shadow: 0 0 20px #8b0000; }
        }

        .risk-badge {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 8px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-top: 10px;
        }
        .risk-low { background: rgba(0, 230, 118, 0.2); color: #00e676; }
        .risk-med { background: rgba(255, 215, 0, 0.2); color: #ffd700; }
        .risk-high { background: rgba(255, 75, 75, 0.2); color: #ff4b4b; }
        .risk-black { background: rgba(0, 0, 0, 0.9); color: #ff0000; }

        /* ITEM REVEAL & LISTS */
        .item-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin: 30px 0;
            text-align: left;
        }
        .item-row {
            background: rgba(0, 0, 0, 0.2);
            padding: 15px 20px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 5px solid transparent;
            transition: all 0.2s;
        }
        .item-row:hover { background: rgba(255,255,255,0.05); }

        .rarity-junk { border-color: #9e9e9e; }
        .rarity-common { border-color: var(--success-color); }
        .rarity-rare { border-color: var(--accent-color); }
        .rarity-legendary { border-color: #ffeb3b; background: linear-gradient(90deg, rgba(255, 235, 59, 0.1), transparent); }

        .certified-badge {
            background: var(--accent-color);
            color: #000;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
            margin-left: 8px;
            vertical-align: middle;
        }

        /* NEGOTIATION SCENE */
        .scene-container {
            display: flex;
            flex-direction: column;
            height: 500px;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
            background: url('https://images.unsplash.com/photo-1550523092-234293e50669?q=80&w=2070&auto=format&fit=crop') center/cover no-repeat;
            box-shadow: inset 0 0 100px rgba(0,0,0,0.8);
            border: 1px solid var(--glass-border);
        }

        /* Dark overlay for the background image */
        .scene-overlay {
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(15, 12, 41, 0.7);
            z-index: 1;
        }

        .eo-avatar-container {
            z-index: 2;
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            margin-top: 20px;
        }

        .eo-avatar {
            font-size: 80px;
            background: radial-gradient(circle, rgba(156, 39, 176, 0.5) 0%, rgba(0,0,0,0) 70%);
            padding: 20px;
            border-radius: 50%;
            animation: float 3s ease-in-out infinite;
            text-shadow: 0 0 30px var(--eo-color);
        }

        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
            100% { transform: translateY(0px); }
        }

        .speech-bubble {
            background: rgba(255, 255, 255, 0.95);
            color: #333;
            padding: 15px 25px;
            border-radius: 20px;
            border-bottom-left-radius: 0;
            max-width: 60%;
            margin-top: 10px;
            font-weight: bold;
            font-size: 1.1rem;
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            position: relative;
            z-index: 3;
            text-align: left;
        }
        .speech-bubble::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            border-width: 10px 10px 0;
            border-style: solid;
            border-color: rgba(255, 255, 255, 0.95) transparent;
        }

        .negotiation-desk {
            z-index: 2;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(20px);
            padding: 20px;
            border-top: 1px solid var(--glass-border);
            display: flex;
            gap: 20px;
            align-items: center;
        }

        .desk-item {
            flex: 1;
            text-align: left;
        }

        .desk-actions {
            flex: 2;
            display: flex;
            flex-wrap: wrap;
            justify-content: flex-end;
            gap: 10px;
        }

        /* HUB MENU */
        .hub-menu {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .hub-card {
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            padding: 30px;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        .hub-card:hover {
            background: rgba(255,255,255,0.15);
            transform: translateY(-5px);
            border-color: var(--accent-color);
        }
        .hub-icon { font-size: 3rem; }
        .hub-title { font-size: 1.2rem; font-weight: bold; }

        /* AUCTION SCREEN */
        .auction-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        .auction-main {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .auction-visual {
            background: rgba(0,0,0,0.3);
            border-radius: 20px;
            padding: 30px;
            position: relative;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            border: 2px solid var(--glass-border);
        }
        .current-bid-display {
            font-size: 4rem;
            font-weight: 900;
            color: var(--success-color);
            text-shadow: 0 0 30px rgba(0, 230, 118, 0.4);
        }
        .timer-display {
            font-size: 1.5rem;
            color: var(--danger-color);
            font-weight: bold;
            margin-top: 10px;
            height: 30px;
        }

        .opponents-grid {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        .opponent-card {
            background: rgba(255,255,255,0.05);
            border: 1px solid var(--glass-border);
            padding: 10px;
            border-radius: 12px;
            width: 80px;
            text-align: center;
            transition: all 0.3s;
            position: relative;
        }
        .opponent-card.active-bidder {
            border-color: var(--char-color);
            background: rgba(255, 255, 255, 0.1);
            transform: scale(1.1);
            box-shadow: 0 0 25px var(--char-color), inset 0 0 10px var(--char-color);
        }
        .opponent-card.folded {
            opacity: 0.3;
            filter: grayscale(1);
        }
        .opponent-avatar { font-size: 2.5rem; }
        .opponent-name { font-size: 0.7rem; margin-top: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .last-action {
            position: absolute;
            top: -10px; right: -10px;
            background: var(--accent-color);
            color: #000;
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 5px;
            font-weight: bold;
            display: none;
        }

        .bid-log {
            background: rgba(0,0,0,0.5);
            height: 150px;
            overflow-y: auto;
            border-radius: 10px;
            padding: 10px;
            text-align: left;
            font-family: monospace;
            font-size: 0.9rem;
            border: 1px solid var(--glass-border);
        }
        .log-entry { margin-bottom: 5px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 2px; }
        .log-entry.high-bid { color: var(--success-color); font-weight: bold; }
        .log-entry.fold { color: var(--danger-color); font-style: italic; }

        .player-controls {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-top: 20px;
        }

        /* SPEECH BUBBLES FOR AUCTION */
        .mini-bubble {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.95);
            border: 2px solid var(--char-color);
            color: #fff;
            padding: 8px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            white-space: nowrap;
            z-index: 100;
            animation: popIn 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            pointer-events: none;
            box-shadow: 0 0 15px var(--char-color);
            text-shadow: none;
            font-weight: bold;
        }

        .bubble-top {
            bottom: 110%;
        }
        .bubble-top::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 8px 8px 0;
            border-style: solid;
            border-color: var(--char-color) transparent transparent transparent;
        }

        .bubble-bottom {
            top: 110%;
        }
        .bubble-bottom::after {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            border-width: 0 8px 8px;
            border-style: solid;
            border-color: transparent transparent var(--char-color) transparent;
        }

        @keyframes popIn {
            from { opacity: 0; transform: translateX(-50%) scale(0.5); }
            to { opacity: 1; transform: translateX(-50%) scale(1); }
        }

    </style>
</head>
<body>

    <header>
        <div class="logo">DepoE ğŸ“¦</div>
        <div class="stats">
            <div class="stat-box">
                <span class="stat-label">ğŸ—“ï¸ TUR</span><br>
                <span id="ui-round">1</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">ğŸ’° BAKÄ°YE</span><br>
                <span id="ui-money" class="money">1000 â‚º</span>
            </div>
            <div class="stat-box">
                <span class="stat-label">ğŸ¤ Ä°TÄ°BAR</span><br>
                <span id="ui-reputation">NÃ¶tr</span>
            </div>
        </div>
    </header>

    <main id="app">
        <!-- Screens will be injected here by JS -->
        <div id="loading" class="screen">
            <h2>YÃ¼kleniyor...</h2>
        </div>
    </main>

    <script>
        // --- CONFIG & CONSTANTS ---
        const GAME_CONFIG = {
            startMoney: 2000, // Enough for a low tier unit
            maxRounds: 999, // Infinite for now
        };

        const RARITY = {
            JUNK: { id: 'junk', label: 'Hurda', color: '#9e9e9e', mult: 0.5 },
            COMMON: { id: 'common', label: 'SÄ±radan', color: '#4caf50', mult: 1.0 },
            RARE: { id: 'rare', label: 'Nadir', color: '#ff9800', mult: 2.5 },
            LEGENDARY: { id: 'legendary', label: 'Efsanevi', color: '#ffeb3b', mult: 10.0 }
        };

        const ITEMS_DB = [
            // JUNK
            { name: "Eski Gazete YÄ±ÄŸÄ±nÄ±", type: "junk", baseValue: 20 },
            { name: "KÄ±rÄ±k Sandalye", type: "junk", baseValue: 50 },
            { name: "PaslÄ± Bisiklet TekerleÄŸi", type: "junk", baseValue: 30 },
            { name: "KÃ¼flÃ¼ Kitaplar", type: "junk", baseValue: 40 },
            { name: "Tek AyakkabÄ±", type: "junk", baseValue: 10 },
            { name: "Bozuk VantilatÃ¶r", type: "junk", baseValue: 80 },
            { name: "Tek Teylik (Sol)", type: "junk", baseValue: 5 },
            { name: "BoÅŸ YoÄŸurt KaplarÄ±", type: "junk", baseValue: 10 },
            { name: "DÃ¼ÄŸÃ¼mÃ¼ Ã‡Ã¶zÃ¼lemeyen Kablo YumaÄŸÄ±", type: "junk", baseValue: 25 },
            { name: "KÄ±rÄ±k Åemsiye", type: "junk", baseValue: 15 },
            { name: "Tarihi GeÃ§miÅŸ Konserveler", type: "junk", baseValue: 30 },
            { name: "Patlak Futbol Topu", type: "junk", baseValue: 20 },
            { name: "Ã‡atlak Plastik Kova", type: "junk", baseValue: 10 },
            { name: "Eski Takvim YapraklarÄ±", type: "junk", baseValue: 5 },

            // COMMON
            { name: "Ä°kinci El Mikrodalga", type: "common", baseValue: 400 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 300 },
            { name: "KullanÄ±lmÄ±ÅŸ Ders KitaplarÄ±", type: "common", baseValue: 250 },
            { name: "Porselen Yemek TakÄ±mÄ± (Eksik)", type: "common", baseValue: 600 },
            { name: "Ã‡alÄ±ÅŸan Tost Makinesi", type: "common", baseValue: 350 },
            { name: "BalÄ±k OltasÄ±", type: "common", baseValue: 500 },
            { name: "Eski Model ÃœtÃ¼", type: "common", baseValue: 200 },
            { name: "TÃ¼plÃ¼ Televizyon", type: "common", baseValue: 300 },
            { name: "Elektrikli Battaniye", type: "common", baseValue: 450 },
            { name: "Dantelli Sehpa Ã–rtÃ¼sÃ¼", type: "common", baseValue: 150 },
            { name: "Mangal TakÄ±mÄ± (Az KullanÄ±lmÄ±ÅŸ)", type: "common", baseValue: 550 },
            { name: "Eski Ansiklopedi Seti", type: "common", baseValue: 200 },
            { name: "DikiÅŸ Makinesi", type: "common", baseValue: 700 },
            { name: "Plastik BahÃ§e Sandalyesi", type: "common", baseValue: 120 },
            { name: "Saz (BaÄŸlama)", type: "common", baseValue: 800 },
            { name: "Bavul Dolusu KÄ±yafet", type: "common", baseValue: 400 },

            // RARE
            { name: "GÃ¼mÃ¼ÅŸ Ã‡atal BÄ±Ã§ak Seti", type: "rare", baseValue: 5000 },
            { name: "1990 YapÄ±mÄ± Oyun Konsolu", type: "rare", baseValue: 6500 },
            { name: "Ä°mzalÄ± Futbol FormasÄ±", type: "rare", baseValue: 8000 },
            { name: "Antika Cep Saati", type: "rare", baseValue: 9500 },
            { name: "Profesyonel Kamera Lensi", type: "rare", baseValue: 7000 },
            { name: "El DokumasÄ± Kilim", type: "rare", baseValue: 6000 },
            { name: "Ä°lk BasÄ±m Ã‡izgi Roman", type: "rare", baseValue: 5500 },
            { name: "Mekanik Daktilo", type: "rare", baseValue: 7500 },
            { name: "BakÄ±r Ä°mbik", type: "rare", baseValue: 6000 },
            { name: "Koleksiyonluk Plak (BarÄ±ÅŸ ManÃ§o)", type: "rare", baseValue: 9000 },
            { name: "Profesyonel Teleskop", type: "rare", baseValue: 8500 },
            { name: "Eski Marka Ã‡akmak (GÃ¼mÃ¼ÅŸ)", type: "rare", baseValue: 5200 },
            { name: "Deri Kovboy Ã‡izmeleri", type: "rare", baseValue: 4500 },
            { name: "Oyuncu BilgisayarÄ± KasasÄ±", type: "rare", baseValue: 9800 },

            // LEGENDARY
            { name: "OsmanlÄ± DÃ¶nemi HanÃ§er", type: "legendary", baseValue: 35000 },
            { name: "AltÄ±n Kolye (18 Ayar)", type: "legendary", baseValue: 28000 },
            { name: "KapalÄ± Kutu Son Model Laptop", type: "legendary", baseValue: 45000 },
            { name: "ÃœnlÃ¼ Bir RessamÄ±n Eskizi", type: "legendary", baseValue: 60000 },
            { name: "Elmas YÃ¼zÃ¼k", type: "legendary", baseValue: 80000 },
            { name: "Meteor ParÃ§asÄ±", type: "legendary", baseValue: 40000 },
            { name: "Ä°mzalÄ± AtatÃ¼rk Portresi (Orijinal)", type: "legendary", baseValue: 95000 },
            { name: "KapalÄ± Kutu Retro Konsol (1985)", type: "legendary", baseValue: 55000 },
            { name: "Viking DÃ¶nemi Balta Ucu", type: "legendary", baseValue: 70000 },
            { name: "Kripto CÃ¼zdan (Åifresi ÃœstÃ¼nde)", type: "legendary", baseValue: 120000 },
            { name: "Safir TaÅŸlÄ± BroÅŸ", type: "legendary", baseValue: 65000 },
            { name: "Hafif Eksik Puzzle", type: "junk", baseValue: 58 },
            { name: "Retro Konsol", type: "rare", baseValue: 3930 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 72 },
            { name: "GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 684 },
            { name: "Antika Komodin", type: "rare", baseValue: 10052 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 90 },
            { name: "Eski Retro Konsol", type: "rare", baseValue: 5930 },
            { name: "Porselen Kupa", type: "common", baseValue: 229 },
            { name: "Porselen Kupa", type: "common", baseValue: 540 },
            { name: "YÄ±pranmÄ±ÅŸ Lego Seti", type: "common", baseValue: 469 },
            { name: "Eski YÃ¼n Kazak", type: "common", baseValue: 628 },
            { name: "Mikrodalga", type: "common", baseValue: 345 },
            { name: "YÄ±pranmÄ±ÅŸ KafasÄ± Kopuk Bebek", type: "junk", baseValue: 38 },
            { name: "KÃ¼Ã§Ã¼k Eski Minder", type: "junk", baseValue: 57 },
            { name: "YÄ±pranmÄ±ÅŸ Masa LambasÄ±", type: "common", baseValue: 718 },
            { name: "Eski Deri Kemer", type: "common", baseValue: 301 },
            { name: "YÄ±pranmÄ±ÅŸ Lekeli Kravat", type: "junk", baseValue: 78 },
            { name: "Tozlu BÄ±Ã§ak Seti", type: "common", baseValue: 586 },
            { name: "Marka Saat", type: "rare", baseValue: 11623 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 514 },
            { name: "Hafif DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 16 },
            { name: "Vintage Kamera", type: "rare", baseValue: 6571 },
            { name: "BÃ¼yÃ¼k Model Araba", type: "common", baseValue: 975 },
            { name: "Patlak Top", type: "junk", baseValue: 89 },
            { name: "AltÄ±n Kaplama iPhone", type: "legendary", baseValue: 49014 },
            { name: "Patlak Top", type: "junk", baseValue: 13 },
            { name: "Porselen Kupa", type: "common", baseValue: 538 },
            { name: "Eski Kristal SÃ¼rahi", type: "rare", baseValue: 6595 },
            { name: "Plastik Tabure", type: "common", baseValue: 442 },
            { name: "Eski Minder", type: "junk", baseValue: 36 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 63 },
            { name: "GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 10886 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 24 },
            { name: "Vintage Kamera", type: "rare", baseValue: 7963 },
            { name: "Tozlu Deri Kemer", type: "common", baseValue: 457 },
            { name: "Gizemli AhÅŸap Sehpa", type: "common", baseValue: 273 },
            { name: "BÃ¼yÃ¼k AhÅŸap Sehpa", type: "common", baseValue: 299 },
            { name: "Gizemli PaslÄ± Kablo", type: "junk", baseValue: 63 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 92 },
            { name: "Antika Komodin", type: "rare", baseValue: 5962 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 16 },
            { name: "Kristal SÃ¼rahi", type: "rare", baseValue: 10399 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 97 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 47 },
            { name: "Gizemli Timsah Derisi Ã‡anta", type: "rare", baseValue: 3097 },
            { name: "Ä°pek EÅŸarp", type: "rare", baseValue: 6286 },
            { name: "AÄŸÄ±r EÄŸri Ã‡atal", type: "junk", baseValue: 73 },
            { name: "Mikrodalga", type: "common", baseValue: 661 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 12 },
            { name: "Gizemli Plastik Tabure", type: "common", baseValue: 384 },
            { name: "Plastik Tabure", type: "common", baseValue: 717 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 755 },
            { name: "Ã‡atlak Tabak", type: "junk", baseValue: 48 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 25 },
            { name: "Tozlu Eski Telefon", type: "common", baseValue: 975 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 80 },
            { name: "YÃ¼n Kazak", type: "common", baseValue: 668 },
            { name: "Model Araba", type: "common", baseValue: 348 },
            { name: "Lego Seti", type: "common", baseValue: 880 },
            { name: "Eski Telefon", type: "common", baseValue: 904 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 64 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 62 },
            { name: "Porselen Kupa", type: "common", baseValue: 987 },
            { name: "Teflon Tava", type: "common", baseValue: 720 },
            { name: "KÃ¼Ã§Ã¼k Patlak Top", type: "junk", baseValue: 67 },
            { name: "GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 11667 },
            { name: "BÃ¼yÃ¼k AhÅŸap Sehpa", type: "common", baseValue: 499 },
            { name: "KÃ¼Ã§Ã¼k Masa LambasÄ±", type: "common", baseValue: 549 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 498 },
            { name: "Mikrodalga", type: "common", baseValue: 689 },
            { name: "BÃ¼yÃ¼k PaslÄ± Kablo", type: "junk", baseValue: 25 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 25 },
            { name: "Lego Seti", type: "common", baseValue: 608 },
            { name: "YÄ±pranmÄ±ÅŸ Plastik Tabure", type: "common", baseValue: 843 },
            { name: "KÃ¼Ã§Ã¼k Ä°pek EÅŸarp", type: "rare", baseValue: 4883 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 844 },
            { name: "Kristal SÃ¼rahi", type: "rare", baseValue: 10491 },
            { name: "Mikrodalga", type: "common", baseValue: 716 },
            { name: "Plastik Tabure", type: "common", baseValue: 651 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 768 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 529 },
            { name: "Plastik Tabure", type: "common", baseValue: 502 },
            { name: "BÃ¼yÃ¼k Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 43 },
            { name: "Antika Komodin", type: "rare", baseValue: 10450 },
            { name: "YÄ±pranmÄ±ÅŸ Eski Telefon", type: "common", baseValue: 218 },
            { name: "BÃ¼yÃ¼k Mikrodalga", type: "common", baseValue: 480 },
            { name: "BÃ¼yÃ¼k KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 72 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 63 },
            { name: "Eski PaslÄ± Tencere", type: "junk", baseValue: 68 },
            { name: "OymalÄ± Ayna", type: "rare", baseValue: 9773 },
            { name: "Tozlu Retro Konsol", type: "rare", baseValue: 5007 },
            { name: "Porselen Kupa", type: "common", baseValue: 239 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 29 },
            { name: "Teflon Tava", type: "common", baseValue: 645 },
            { name: "BÃ¼yÃ¼k KafasÄ± Kopuk Bebek", type: "junk", baseValue: 75 },
            { name: "Hafif SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 703 },
            { name: "Deri Kemer", type: "common", baseValue: 642 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 84 },
            { name: "BÃ¼yÃ¼k PaslÄ± Tencere", type: "junk", baseValue: 43 },
            { name: "Eski Telefon", type: "common", baseValue: 568 },
            { name: "Mikrodalga", type: "common", baseValue: 906 },
            { name: "Eski Minder", type: "junk", baseValue: 40 },
            { name: "GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 4213 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 19 },
            { name: "YÃ¼n Kazak", type: "common", baseValue: 539 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 45 },
            { name: "Hafif Antika Komodin", type: "rare", baseValue: 9247 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 80 },
            { name: "KÃ¼Ã§Ã¼k Ã‡atlak Tabak", type: "junk", baseValue: 91 },
            { name: "Plastik Tabure", type: "common", baseValue: 312 },
            { name: "Tozlu KitaplÄ±k RafÄ±", type: "common", baseValue: 939 },
            { name: "Plastik Tabure", type: "common", baseValue: 984 },
            { name: "Deri Kemer", type: "common", baseValue: 512 },
            { name: "Eski KafasÄ± Kopuk Bebek", type: "junk", baseValue: 46 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 61 },
            { name: "BÃ¼yÃ¼k EÄŸri Ã‡atal", type: "junk", baseValue: 74 },
            { name: "BÃ¼yÃ¼k Lekeli Kravat", type: "junk", baseValue: 27 },
            { name: "Eski Porselen Kupa", type: "common", baseValue: 780 },
            { name: "Tozlu Lekeli Kravat", type: "junk", baseValue: 32 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 46 },
            { name: "Antika Komodin", type: "rare", baseValue: 10445 },
            { name: "Antika Komodin", type: "rare", baseValue: 10071 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 39 },
            { name: "BÃ¼yÃ¼k AhÅŸap Sehpa", type: "common", baseValue: 720 },
            { name: "Hafif Porselen Kupa", type: "common", baseValue: 456 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 74 },
            { name: "Eski Minder", type: "junk", baseValue: 40 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 94 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 58 },
            { name: "Hafif Eski Telefon", type: "common", baseValue: 604 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 33 },
            { name: "Tozlu KafasÄ± Kopuk Bebek", type: "junk", baseValue: 100 },
            { name: "Hafif Deri Kemer", type: "common", baseValue: 224 },
            { name: "AÄŸÄ±r Plastik Tabure", type: "common", baseValue: 281 },
            { name: "Teflon Tava", type: "common", baseValue: 961 },
            { name: "KÃ¼Ã§Ã¼k Bozuk Radyo", type: "junk", baseValue: 46 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 100 },
            { name: "Timsah Derisi Ã‡anta", type: "rare", baseValue: 8862 },
            { name: "KÃ¼Ã§Ã¼k KafasÄ± Kopuk Bebek", type: "junk", baseValue: 44 },
            { name: "Eski Telefon", type: "common", baseValue: 388 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 12 },
            { name: "Eski Minder", type: "junk", baseValue: 87 },
            { name: "Lego Seti", type: "common", baseValue: 977 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 32 },
            { name: "OymalÄ± Ayna", type: "rare", baseValue: 7351 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 15 },
            { name: "YÄ±pranmÄ±ÅŸ Ã‡atlak Tabak", type: "junk", baseValue: 82 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 31 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 379 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 686 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 22 },
            { name: "Gizemli SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 883 },
            { name: "Eski Patlak Top", type: "junk", baseValue: 68 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 29 },
            { name: "GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 900 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 242 },
            { name: "Kristal SÃ¼rahi", type: "rare", baseValue: 3047 },
            { name: "Porselen Kupa", type: "common", baseValue: 778 },
            { name: "Patlak Top", type: "junk", baseValue: 19 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 37 },
            { name: "Eski Minder", type: "junk", baseValue: 99 },
            { name: "GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 5139 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 435 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 58 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 24 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 68 },
            { name: "Tozlu Timsah Derisi Ã‡anta", type: "rare", baseValue: 11873 },
            { name: "AÄŸÄ±r Eski Minder", type: "junk", baseValue: 72 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 70 },
            { name: "Eski Telefon", type: "common", baseValue: 622 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 77 },
            { name: "YÃ¼n Kazak", type: "common", baseValue: 364 },
            { name: "Ã‡atlak Tabak", type: "junk", baseValue: 81 },
            { name: "Mikrodalga", type: "common", baseValue: 471 },
            { name: "BÃ¼yÃ¼k Eksik Puzzle", type: "junk", baseValue: 77 },
            { name: "GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 677 },
            { name: "Timsah Derisi Ã‡anta", type: "rare", baseValue: 11199 },
            { name: "AÄŸÄ±r AhÅŸap Sehpa", type: "common", baseValue: 930 },
            { name: "Marka Saat", type: "rare", baseValue: 11496 },
            { name: "Eski Telefon", type: "common", baseValue: 542 },
            { name: "Gizemli Porselen Kupa", type: "common", baseValue: 574 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 29 },
            { name: "Gizemli PaslÄ± Kablo", type: "junk", baseValue: 86 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 66 },
            { name: "Eski Antika Komodin", type: "rare", baseValue: 4518 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 93 },
            { name: "Patlak Top", type: "junk", baseValue: 55 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 98 },
            { name: "BÃ¼yÃ¼k BÄ±Ã§ak Seti", type: "common", baseValue: 230 },
            { name: "AÄŸÄ±r Lego Seti", type: "common", baseValue: 664 },
            { name: "Tozlu Eski Telefon", type: "common", baseValue: 253 },
            { name: "KÃ¼Ã§Ã¼k Koleksiyonluk Kart", type: "rare", baseValue: 11083 },
            { name: "YÄ±pranmÄ±ÅŸ YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 67 },
            { name: "Plastik Tabure", type: "common", baseValue: 707 },
            { name: "Porselen Kupa", type: "common", baseValue: 941 },
            { name: "Porselen Kupa", type: "common", baseValue: 641 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 69 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 34 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 826 },
            { name: "Eski YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 54 },
            { name: "Hafif EÄŸri Ã‡atal", type: "junk", baseValue: 14 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 587 },
            { name: "BÃ¼yÃ¼k Lekeli Kravat", type: "junk", baseValue: 64 },
            { name: "Patlak Top", type: "junk", baseValue: 53 },
            { name: "KÃ¼Ã§Ã¼k OymalÄ± Ayna", type: "rare", baseValue: 11898 },
            { name: "Gizemli PaslÄ± Tencere", type: "junk", baseValue: 29 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 71 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 51 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 728 },
            { name: "Lego Seti", type: "common", baseValue: 856 },
            { name: "KÃ¼Ã§Ã¼k Ã‡atlak Tabak", type: "junk", baseValue: 44 },
            { name: "Marka Saat", type: "rare", baseValue: 6818 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 35 },
            { name: "BÃ¼yÃ¼k DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 53 },
            { name: "AÄŸÄ±r Ä°mzalÄ± Forma", type: "rare", baseValue: 9975 },
            { name: "Mikrodalga", type: "common", baseValue: 793 },
            { name: "Mikrodalga", type: "common", baseValue: 651 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 909 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 627 },
            { name: "Plastik Tabure", type: "common", baseValue: 277 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 96 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 49 },
            { name: "Teflon Tava", type: "common", baseValue: 281 },
            { name: "Gizemli BÄ±Ã§ak Seti", type: "common", baseValue: 947 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 97 },
            { name: "Vintage Kamera", type: "rare", baseValue: 5599 },
            { name: "BÃ¼yÃ¼k DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 71 },
            { name: "Gizemli Model Araba", type: "common", baseValue: 651 },
            { name: "Hafif EÄŸri Ã‡atal", type: "junk", baseValue: 32 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 94 },
            { name: "Patlak Top", type: "junk", baseValue: 43 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 640 },
            { name: "Antika Komodin", type: "rare", baseValue: 10396 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 450 },
            { name: "Porselen Kupa", type: "common", baseValue: 264 },
            { name: "Deri Koltuk", type: "rare", baseValue: 10370 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 68 },
            { name: "Ä°lk BasÄ±m Ã‡izgi Roman", type: "rare", baseValue: 9215 },
            { name: "Tozlu Ä°pek EÅŸarp", type: "rare", baseValue: 3860 },
            { name: "Hafif SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 329 },
            { name: "Deri Kemer", type: "common", baseValue: 507 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 95 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 63 },
            { name: "KÃ¼Ã§Ã¼k AhÅŸap Sehpa", type: "common", baseValue: 966 },
            { name: "Hafif Lego Seti", type: "common", baseValue: 923 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 498 },
            { name: "Eski Minder", type: "junk", baseValue: 40 },
            { name: "BakÄ±r Kazan", type: "rare", baseValue: 6792 },
            { name: "YÃ¼n Kazak", type: "common", baseValue: 568 },
            { name: "Plastik Tabure", type: "common", baseValue: 447 },
            { name: "Eski Minder", type: "junk", baseValue: 31 },
            { name: "BÃ¼yÃ¼k Patlak Top", type: "junk", baseValue: 100 },
            { name: "Eski GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 814 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 37 },
            { name: "Deri Kemer", type: "common", baseValue: 503 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 424 },
            { name: "Timsah Derisi Ã‡anta", type: "rare", baseValue: 11747 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 88 },
            { name: "YÄ±pranmÄ±ÅŸ GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 934 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 82 },
            { name: "Gizemli Kristal SÃ¼rahi", type: "rare", baseValue: 7148 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 680 },
            { name: "Plastik Tabure", type: "common", baseValue: 518 },
            { name: "Model Araba", type: "common", baseValue: 743 },
            { name: "Kraliyet TahtÄ± Taklidi", type: "legendary", baseValue: 91428 },
            { name: "GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 10392 },
            { name: "AÄŸÄ±r GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 799 },
            { name: "Gizemli Masa LambasÄ±", type: "common", baseValue: 799 },
            { name: "BÃ¼yÃ¼k GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 10109 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 22 },
            { name: "Hafif SÄ±nÄ±rlÄ± Ãœretim FigÃ¼r", type: "legendary", baseValue: 49373 },
            { name: "Gizemli BakÄ±r Kazan", type: "rare", baseValue: 4517 },
            { name: "Eski BakÄ±r Kazan", type: "rare", baseValue: 4125 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 97 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 36 },
            { name: "Plastik Tabure", type: "common", baseValue: 866 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 855 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 77 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 22 },
            { name: "Gizemli Kraliyet TahtÄ± Taklidi", type: "legendary", baseValue: 144145 },
            { name: "Gizemli Deri Kemer", type: "common", baseValue: 700 },
            { name: "AÄŸÄ±r PaslÄ± Kablo", type: "junk", baseValue: 90 },
            { name: "Hafif Lekeli Kravat", type: "junk", baseValue: 41 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 50 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 95 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 419 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 19 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 77 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 34 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 23 },
            { name: "KÃ¼Ã§Ã¼k Patlak Top", type: "junk", baseValue: 62 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 373 },
            { name: "Kristal SÃ¼rahi", type: "rare", baseValue: 4360 },
            { name: "BÃ¼yÃ¼k KÄ±rÄ±k Ekran", type: "junk", baseValue: 28 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 75 },
            { name: "Eski Telefon", type: "common", baseValue: 231 },
            { name: "Gizemli Deri Kemer", type: "common", baseValue: 927 },
            { name: "BakÄ±r Kazan", type: "rare", baseValue: 3156 },
            { name: "Eski Telefon", type: "common", baseValue: 648 },
            { name: "KÃ¼Ã§Ã¼k Ä°pek EÅŸarp", type: "rare", baseValue: 9619 },
            { name: "Teflon Tava", type: "common", baseValue: 253 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 519 },
            { name: "KÃ¼Ã§Ã¼k Retro Konsol", type: "rare", baseValue: 5716 },
            { name: "YÄ±pranmÄ±ÅŸ KitaplÄ±k RafÄ±", type: "common", baseValue: 608 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 47 },
            { name: "Deri Koltuk", type: "rare", baseValue: 6839 },
            { name: "Tozlu YÃ¼n Kazak", type: "common", baseValue: 279 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 291 },
            { name: "Tozlu GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 805 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 22 },
            { name: "Eski Porselen Kupa", type: "common", baseValue: 430 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 10 },
            { name: "Hafif Ã‡atlak Tabak", type: "junk", baseValue: 20 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 210 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 82 },
            { name: "YÄ±pranmÄ±ÅŸ GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 708 },
            { name: "AÄŸÄ±r Patlak Top", type: "junk", baseValue: 28 },
            { name: "Gitar Amfisi", type: "rare", baseValue: 7132 },
            { name: "Koleksiyonluk Kart", type: "rare", baseValue: 5261 },
            { name: "Deri Koltuk", type: "rare", baseValue: 10545 },
            { name: "Hafif YÃ¼n Kazak", type: "common", baseValue: 209 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 63 },
            { name: "YÄ±pranmÄ±ÅŸ OymalÄ± Ayna", type: "rare", baseValue: 10910 },
            { name: "Gizemli Eski Telefon", type: "common", baseValue: 349 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 11 },
            { name: "Model Araba", type: "common", baseValue: 948 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 78 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 899 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 32 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 19 },
            { name: "Ä°lk BasÄ±m Ã‡izgi Roman", type: "rare", baseValue: 4711 },
            { name: "Patlak Top", type: "junk", baseValue: 31 },
            { name: "Kristal SÃ¼rahi", type: "rare", baseValue: 10329 },
            { name: "Eski Minder", type: "junk", baseValue: 79 },
            { name: "Ä°mzalÄ± Forma", type: "rare", baseValue: 3406 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 49 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 573 },
            { name: "Tozlu Eski Minder", type: "junk", baseValue: 52 },
            { name: "Ã‡atlak Tabak", type: "junk", baseValue: 80 },
            { name: "Eski Telefon", type: "common", baseValue: 751 },
            { name: "Porselen Kupa", type: "common", baseValue: 838 },
            { name: "Porselen Kupa", type: "common", baseValue: 303 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 96 },
            { name: "GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 641 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 353 },
            { name: "Tozlu Eksik Puzzle", type: "junk", baseValue: 47 },
            { name: "Antika Komodin", type: "rare", baseValue: 3886 },
            { name: "YÄ±pranmÄ±ÅŸ Eski Minder", type: "junk", baseValue: 55 },
            { name: "YÃ¼n Kazak", type: "common", baseValue: 235 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 20 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 91 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 78 },
            { name: "KÃ¼Ã§Ã¼k Ä°mzalÄ± Forma", type: "rare", baseValue: 11596 },
            { name: "Plastik Tabure", type: "common", baseValue: 893 },
            { name: "KÃ¼Ã§Ã¼k Timsah Derisi Ã‡anta", type: "rare", baseValue: 3751 },
            { name: "Porselen Kupa", type: "common", baseValue: 366 },
            { name: "Teflon Tava", type: "common", baseValue: 223 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 12 },
            { name: "Hafif Paha BiÃ§ilemez Bebek", type: "legendary", baseValue: 31009 },
            { name: "AÄŸÄ±r Lego Seti", type: "common", baseValue: 908 },
            { name: "Ã‡atlak Tabak", type: "junk", baseValue: 31 },
            { name: "Kraliyet TahtÄ± Taklidi", type: "legendary", baseValue: 67398 },
            { name: "Hafif PaslÄ± Tencere", type: "junk", baseValue: 63 },
            { name: "Patlak Top", type: "junk", baseValue: 66 },
            { name: "Ä°mzalÄ± Forma", type: "rare", baseValue: 8141 },
            { name: "Porselen Kupa", type: "common", baseValue: 495 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 12 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 49 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 11 },
            { name: "AÄŸÄ±r Koleksiyonluk Kart", type: "rare", baseValue: 3373 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 63 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 71 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 47 },
            { name: "OymalÄ± Ayna", type: "rare", baseValue: 8707 },
            { name: "Hafif GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 964 },
            { name: "Vintage Kamera", type: "rare", baseValue: 10006 },
            { name: "BÃ¼yÃ¼k KÄ±rÄ±k Ekran", type: "junk", baseValue: 11 },
            { name: "AltÄ±n Kaplama iPhone", type: "legendary", baseValue: 33291 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 52 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 90 },
            { name: "Hafif Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 74 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 30 },
            { name: "Deri Koltuk", type: "rare", baseValue: 3856 },
            { name: "YÄ±pranmÄ±ÅŸ Hanedan Vazosu", type: "legendary", baseValue: 78459 },
            { name: "Eski Lekeli Kravat", type: "junk", baseValue: 48 },
            { name: "BÃ¼yÃ¼k Marka Saat", type: "rare", baseValue: 11685 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 22 },
            { name: "OymalÄ± Ayna", type: "rare", baseValue: 5930 },
            { name: "Ã‡atlak Tabak", type: "junk", baseValue: 19 },
            { name: "Teflon Tava", type: "common", baseValue: 562 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 380 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 31 },
            { name: "Tozlu Kraliyet TahtÄ± Taklidi", type: "legendary", baseValue: 83398 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 522 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 95 },
            { name: "Tozlu Deri Koltuk", type: "rare", baseValue: 8654 },
            { name: "BÃ¼yÃ¼k Eski Minder", type: "junk", baseValue: 57 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 524 },
            { name: "YÄ±pranmÄ±ÅŸ Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 73 },
            { name: "Mikrodalga", type: "common", baseValue: 677 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 78 },
            { name: "Lego Seti", type: "common", baseValue: 857 },
            { name: "Hafif Lego Seti", type: "common", baseValue: 698 },
            { name: "Eski Telefon", type: "common", baseValue: 667 },
            { name: "Tozlu KÄ±rÄ±k Ekran", type: "junk", baseValue: 18 },
            { name: "BÃ¼yÃ¼k Eksik Puzzle", type: "junk", baseValue: 100 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 47 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 64 },
            { name: "Porselen Kupa", type: "common", baseValue: 468 },
            { name: "Patlak Top", type: "junk", baseValue: 96 },
            { name: "Porselen Kupa", type: "common", baseValue: 953 },
            { name: "Hafif Eski Telefon", type: "common", baseValue: 623 },
            { name: "Porselen Kupa", type: "common", baseValue: 670 },
            { name: "Marka Saat", type: "rare", baseValue: 8152 },
            { name: "Ä°pek EÅŸarp", type: "rare", baseValue: 6762 },
            { name: "KÃ¼Ã§Ã¼k PaslÄ± Kablo", type: "junk", baseValue: 86 },
            { name: "Hafif Patlak Top", type: "junk", baseValue: 39 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 20 },
            { name: "GÃ¼mÃ¼ÅŸ Åamdan", type: "rare", baseValue: 11722 },
            { name: "KÃ¼Ã§Ã¼k AhÅŸap Sehpa", type: "common", baseValue: 570 },
            { name: "Model Araba", type: "common", baseValue: 291 },
            { name: "Ä°lk BasÄ±m Ã‡izgi Roman", type: "rare", baseValue: 7228 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 64 },
            { name: "KÃ¼Ã§Ã¼k Porselen Kupa", type: "common", baseValue: 515 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 93 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 573 },
            { name: "YÄ±pranmÄ±ÅŸ EÄŸri Ã‡atal", type: "junk", baseValue: 61 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 31 },
            { name: "Deri Koltuk", type: "rare", baseValue: 4077 },
            { name: "Eski Lekeli Kravat", type: "junk", baseValue: 59 },
            { name: "Hafif Vintage Kamera", type: "rare", baseValue: 7674 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 326 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 72 },
            { name: "BÃ¼yÃ¼k KÄ±rÄ±k Ekran", type: "junk", baseValue: 38 },
            { name: "Lekeli Kravat", type: "junk", baseValue: 17 },
            { name: "Deri Koltuk", type: "rare", baseValue: 7758 },
            { name: "SultanÄ±n Sediri", type: "legendary", baseValue: 63373 },
            { name: "Hafif DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 62 },
            { name: "KitaplÄ±k RafÄ±", type: "common", baseValue: 603 },
            { name: "OymalÄ± Ayna", type: "rare", baseValue: 6816 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 35 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 482 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 23 },
            { name: "Eski Telefon", type: "common", baseValue: 628 },
            { name: "Teflon Tava", type: "common", baseValue: 425 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 59 },
            { name: "Hafif SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 433 },
            { name: "AÄŸÄ±r EÄŸri Ã‡atal", type: "junk", baseValue: 52 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 86 },
            { name: "Ã‡Ã¼rÃ¼k Tahta", type: "junk", baseValue: 86 },
            { name: "KÄ±rÄ±k Ekran", type: "junk", baseValue: 47 },
            { name: "Prototip Laptop", type: "legendary", baseValue: 65689 },
            { name: "OymalÄ± Ayna", type: "rare", baseValue: 4784 },
            { name: "KÃ¼Ã§Ã¼k Ä°pek EÅŸarp", type: "rare", baseValue: 8092 },
            { name: "Model Araba", type: "common", baseValue: 952 },
            { name: "Hafif Masa LambasÄ±", type: "common", baseValue: 732 },
            { name: "YÃ¼n Kazak", type: "common", baseValue: 342 },
            { name: "AhÅŸap Sehpa", type: "common", baseValue: 687 },
            { name: "BÄ±Ã§ak Seti", type: "common", baseValue: 592 },
            { name: "Eski Minder", type: "junk", baseValue: 12 },
            { name: "AÄŸÄ±r GÃ¼neÅŸ GÃ¶zlÃ¼ÄŸÃ¼", type: "common", baseValue: 653 },
            { name: "Eski Minder", type: "junk", baseValue: 90 },
            { name: "Ä°lk BasÄ±m Ã‡izgi Roman", type: "rare", baseValue: 3393 },
            { name: "Patlak Top", type: "junk", baseValue: 99 },
            { name: "PaslÄ± Tencere", type: "junk", baseValue: 39 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 46 },
            { name: "Model Araba", type: "common", baseValue: 878 },
            { name: "Model Araba", type: "common", baseValue: 1000 },
            { name: "PÄ±rlanta KÃ¼pe", type: "legendary", baseValue: 137784 },
            { name: "Mikrodalga", type: "common", baseValue: 932 },
            { name: "Teflon Tava", type: "common", baseValue: 778 },
            { name: "Eski Minder", type: "junk", baseValue: 78 },
            { name: "Plastik Tabure", type: "common", baseValue: 440 },
            { name: "PaslÄ± Kablo", type: "junk", baseValue: 20 },
            { name: "Masa LambasÄ±", type: "common", baseValue: 261 },
            { name: "BÃ¼yÃ¼k YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 13 },
            { name: "YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 80 },
            { name: "KÄ±rÄ±k Sandalye AyacaÄŸÄ±", type: "junk", baseValue: 70 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 17 },
            { name: "Hafif BakÄ±r Kazan", type: "rare", baseValue: 10985 },
            { name: "Hafif Plastik Tabure", type: "common", baseValue: 543 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 51 },
            { name: "Patlak Top", type: "junk", baseValue: 18 },
            { name: "Tozlu Porselen Kupa", type: "common", baseValue: 782 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 51 },
            { name: "SatranÃ§ TakÄ±mÄ±", type: "common", baseValue: 819 },
            { name: "Bozuk Radyo", type: "junk", baseValue: 40 },
            { name: "Tozlu Masa LambasÄ±", type: "common", baseValue: 276 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 38 },
            { name: "Hafif YÄ±rtÄ±k Ã‡orap", type: "junk", baseValue: 60 },
            { name: "Plastik Tabure", type: "common", baseValue: 579 },
            { name: "Ä°pek EÅŸarp", type: "rare", baseValue: 9296 },
            { name: "Ã‡atlak Tabak", type: "junk", baseValue: 89 },
            { name: "DÃ¼ÄŸmesi Kopuk Ceket", type: "junk", baseValue: 51 },
            { name: "EÄŸri Ã‡atal", type: "junk", baseValue: 97 },
            { name: "KafasÄ± Kopuk Bebek", type: "junk", baseValue: 86 },
            { name: "Eksik Puzzle", type: "junk", baseValue: 92 },
            { name: "Deri Kemer", type: "common", baseValue: 924 },
            { name: "YÄ±pranmÄ±ÅŸ Masa LambasÄ±", type: "common", baseValue: 423 },
            { name: "Kraliyet TahtÄ± Taklidi", type: "legendary", baseValue: 73188 },
        ];

        // --- OPPONENTS ---
        const OPPONENTS = [
            { id: 'yilong', name: 'Yilong Ma', avatar: 'ğŸš€', wealth: 999999, aggressive: 0.9, patience: 2, desc: 'Teknoloji Milyarderi', color: '#00d2d3' },
            { id: 'hasan', name: 'HurdacÄ± Hasan', avatar: 'ğŸ§¢', wealth: 5000, aggressive: 0.3, patience: 5, desc: 'Eski Toprak', color: '#ff9f43' },
            { id: 'daniel', name: 'Jew Daniel', avatar: 'ğŸ’', wealth: 50000, aggressive: 0.7, patience: 4, desc: 'Kuyumcu', color: '#feca57' },
            { id: 'cilem', name: 'Bitmeyen Ã‡ilem', avatar: 'ğŸš¬', wealth: 2000, aggressive: 0.1, patience: 1, desc: 'ÅanssÄ±z', color: '#ff6b6b' }
        ];

        const OPPONENT_LINES = {
            yilong: {
                bid: [
                    "To the moon! ğŸš€",
                    "è¿™æ˜¯æˆ‘çš„!",  // (This is mine!)
                    "Buying this for Mars colony.",
                    "æˆ‘è¦è¿™ä¸ª!",  // (I want this!)
                    "Paying with Doge.",
                    "Technology is the future!",
                    "å¤ªå¥½äº†!"     // (Great!)
                ],
                fold: [
                    "ä¸!",        // (No!)
                    "Boring.",
                    "Paper hands...",
                    "æ²¡æœ‰æ„æ€.",   // (Boring/Not interesting)
                    "Waiting for the dip."
                ],
                random: [
                    "ä½ å¥½å—?",     // (How are you?)
                    "When Lambo?",
                    "My rocket is ready.",
                    "æˆ‘ä»¬å»ç«æ˜Ÿ!", // (Let's go to Mars!)
                    "420.69 is the magic number."
                ]
            },
            hasan: {
                bid: [
                    "PaslÄ± maslÄ± ama iÅŸ gÃ¶rÃ¼r.",
                    "HurdasÄ± para eder bunun.",
                    "AtÄ±n Ã¶lÃ¼mÃ¼ arpadan olsun.",
                    "Aman, demiri iyi duruyor.",
                    "ÃœÃ§ beÅŸ bir ÅŸey ateÅŸleriz."
                ],
                fold: [
                    "O paraya kamyon alÄ±rÄ±m be!",
                    "Soygun var polis!",
                    "Hadi ordan, teneke bu.",
                    "Kurtarmaz yeÄŸenim, kurtarmaz.",
                    "Bu fiyata hurda alÄ±nmaz."
                ],
                random: [
                    "Eskiciiiii!",
                    "Demir fiyatlarÄ± dÃ¼ÅŸtÃ¼ mÃ¼?",
                    "Ã‡ay sÃ¶yleyin de iÃ§elim.",
                    "Bizim oÄŸlanÄ± sanayiye verdim.",
                    "Eski devir kalmadÄ± azizim."
                ]
            },
            daniel: {
                bid: [
                    "A fair price... barely.",
                    "I smell a profit margin here.",
                    "Mazel tov! I'm in.",
                    "With a little polish, I can flip this.",
                    "Such a deal, I'd be meshuga to pass.",
                    "Good business is where you find it."
                ],
                fold: [
                    "Oy vey! Look at that price!",
                    "You are robbing me blind!",
                    "Where is the profit? Nowhere!",
                    "Too rich for my blood.",
                    "Such chutzpah asking for this much!",
                    "I'm out. My mother raised no fool."
                ],
                random: [
                    "Time is money, friend.",
                    "You call this a storage unit?",
                    "I know a guy who knows a guy...",
                    "Buy wholesale, sell retail. Simple.",
                    "Nu? Are we bidding or staring?"
                ]
            },
            cilem: {
                bid: [
                    "Ã‡oluk Ã§ocuÄŸun rÄ±zkÄ±nÄ± basÄ±yorum...",
                    "Ah, yine piÅŸman olacaÄŸÄ±m.",
                    "Son kuruÅŸumla...",
                    "Belki bu sefer yÃ¼zÃ¼m gÃ¼ler?",
                    "Buna da girelim bakalÄ±m, ne Ã§Ä±karsa..."
                ],
                fold: [
                    "Biliyordum... Hep bÃ¶yle olur.",
                    "Zaten ÅŸansÄ±m yok.",
                    "Kaderimse Ã§ekerim.",
                    "Bu dÃ¼nya bana dar.",
                    "Yine kaybettim, alÄ±ÅŸÄ±ÄŸÄ±m.",
                    "Param yetmez ki..."
                ],
                random: [
                    "BaÅŸÄ±ma giren aÄŸrÄ±lar...",
                    "Kesin boÅŸ Ã§Ä±kacak, hissediyorum.",
                    "Neden doÄŸdum ki?",
                    "AkÅŸam eve ne gÃ¶tÃ¼receÄŸim?",
                    "Off off... YÃ¼zÃ¼mÃ¼z gÃ¼lmedi."
                ]
            }
        };

        // --- SKILLS CONFIGURATION ---
        const SKILLS_CONFIG = {
            xray: {
                id: 'xray',
                name: 'RÃ¶ntgen GÃ¶zler',
                maxLevel: 3,
                cost: 1,
                desc: 'KutularÄ±n riskini daha iyi analiz etme ÅŸansÄ± saÄŸlar.'
            },
            silverTongue: {
                id: 'silverTongue',
                name: 'TatlÄ± Dil',
                maxLevel: 3,
                cost: 1,
                desc: 'PazarlÄ±kta EO\'nun sabrÄ±nÄ± daha az tÃ¼ketirsin.'
            },
            restorer: {
                id: 'restorer',
                name: 'Usta Tamirci',
                maxLevel: 5,
                cost: 1,
                desc: 'AtÃ¶lyede hurda eÅŸyalarÄ± onarma ÅŸansÄ±nÄ± artÄ±rÄ±r.'
            },
            hoarder: {
                id: 'hoarder',
                name: 'Ä°stifÃ§i',
                maxLevel: 5,
                cost: 1,
                desc: 'Depo kapasitesini kalÄ±cÄ± olarak +5 artÄ±rÄ±r.'
            }
        };

        // --- EO INTELLIGENCE ---
        const EO_AI = {
            mood: 'neutral', // neutral, happy, annoyed, angry
            patience: 3, // Lowers with bad offers

            dialogue: {
                "greeting": {
                                "friendly": [
                                                "Vay vay vay! Åehrin en diÅŸli tÃ¼ccarÄ± yine iÅŸ baÅŸÄ±nda mÄ±?",
                                                "Geldin yine gÃ¶nlÃ¼mÃ¼n efendisi, bakalÄ±m bugÃ¼n cÃ¼zdanÄ±mÄ± nasÄ±l boÅŸaltacaksÄ±n?",
                                                "HoÅŸ geldin ÅŸampiyon! BugÃ¼n senin iÃ§in Ã¶zel bir indirim... yok ÅŸaka yaptÄ±m, fiyatlar aynÄ±.",
                                                "Seni gÃ¶rÃ¼nce dÃ¼kkana gÃ¼neÅŸ doÄŸuyor resmen. Ne getirdin bakalÄ±m?",
                                                "Dostum! Yine hangi hazinelerle geldin? Meraktan Ã¶lÃ¼yorum.",
                                                "Gel otur ÅŸÃ¶yle, Ã§ay sÃ¶yleyeyim... demeyi isterdim ama iÅŸ vakti! GÃ¶ster mallarÄ±.",
                                                "En sevdiÄŸim tedarikÃ§im gelmiÅŸ. UmarÄ±m beni ÅŸaÅŸÄ±rtÄ±rsÄ±n.",
                                                "Seninle iÅŸ yapmak her zaman bir zevk. BugÃ¼n neyimiz var?",
                                                "Yine o meÅŸhur depolarÄ±ndan bir ÅŸeyler mi Ã§Ä±kardÄ±n?",
                                                "BakÄ±yorum da keyfin yerinde, demek ki gÃ¼zel mallar var."
                                ],
                                "neutral": [
                                                "Ä°ÅŸler nasÄ±l gidiyor? BakalÄ±m bugÃ¼n neler var.",
                                                "Yeni mallar mÄ±? ÅÃ¶yle bir gÃ¶z atalÄ±m.",
                                                "Vaktin varsa mallarÄ± gÃ¶ster, yoksa kalabalÄ±k etme.",
                                                "DÃ¼kkan senin, ama fiyatlar benim. Ne getirdin?",
                                                "SÄ±radaki! Ah, sensin. GÃ¶ster bakalÄ±m elindekileri.",
                                                "Piyasa bugÃ¼nlerde durgun, umarÄ±m ilgi Ã§ekici bir ÅŸeylerin vardÄ±r.",
                                                "Hadi hÄ±zlÄ± olalÄ±m, bekleyen iÅŸler var.",
                                                "EÅŸyalara bir bakalÄ±m, belki iÅŸime yarar bir ÅŸeyler Ã§Ä±kar.",
                                                "BugÃ¼n ÅŸanslÄ± mÄ±sÄ±n bakalÄ±m? Neler topladÄ±n?",
                                                "Depolardan ne Ã§Ä±ktÄ± bugÃ¼n?"
                                ],
                                "suspicious": [
                                                "Yine mi sen? Bu sefer Ã§alÄ±ntÄ± bir ÅŸey getirmedin umarÄ±m.",
                                                "GÃ¶zÃ¼m Ã¼zerinde, sakÄ±n beni kandÄ±rmaya Ã§alÄ±ÅŸma.",
                                                "Ã‡abuk ol ve eÅŸyalarÄ± gÃ¶ster. Fazla vaktim yok.",
                                                "DÃ¼kkanÄ±ma girmeden Ã¶nce ellerini yÄ±kadÄ±n mÄ±? Ne istiyorsun?",
                                                "ÅÃ¼pheli bir hareketini gÃ¶rÃ¼rsem polisi ararÄ±m, ona gÃ¶re.",
                                                "Sana gÃ¼venmiyorum, ama mallarÄ±na bir bakabilirim.",
                                                "Bu mallarÄ±n kaynaÄŸÄ± nedir? UmarÄ±m baÅŸÄ±mÄ± aÄŸrÄ±tmazsÄ±n.",
                                                "Yine o tekinsiz depolardan mÄ± geliyorsun?",
                                                "Burada dÃ¼rÃ¼stlÃ¼k esastÄ±r, ama senin tipinde o pek yok gibi.",
                                                "HÄ±zlÄ± gÃ¶ster ve git. SabrÄ±m Ã§ok az bugÃ¼n."
                                ]
                },
                "inspecting": {
                                "friendly": [
                                                "BakalÄ±m, bakalÄ±m... HÄ±mm, bu gerÃ§ekten ilginÃ§ gÃ¶rÃ¼nÃ¼yor.",
                                                "Vay canÄ±na, bunu nereden buldun? Harika bir parÃ§a!",
                                                "Senden de hep bÃ¶yle kaliteli ÅŸeyler Ã§Ä±kÄ±yor zaten.",
                                                "Bunu dÃ¼kkanÄ±n en Ã¶nÃ¼ne koymalÄ±yÄ±m. Åahane!",
                                                "HÄ±mm, biraz temizlikle bu harika olur. GÃ¼zel seÃ§im.",
                                                "Åu iÅŸÃ§iliÄŸe bak, gerÃ§ekten nadide bir parÃ§a.",
                                                "Bunu bulduÄŸuna inanamÄ±yorum, gerÃ§ekten ÅŸanslÄ±sÄ±n.",
                                                "Bunu benim iÃ§in mi sakladÄ±n? Ã‡ok dÃ¼ÅŸÃ¼ncelisin.",
                                                "GerÃ§ekten gÃ¶zÃ¼n Ã§ok keskin, yine en iyisini bulmuÅŸsun.",
                                                "Bu parÃ§a dÃ¼kkanÄ±ma deÄŸer katar."
                                ],
                                "neutral": [
                                                "ÅÃ¶yle bir bakalÄ±m... Standart bir ÅŸeye benziyor.",
                                                "Ä°ÅŸ gÃ¶rÃ¼r gibi, ama piyasasÄ± var mÄ± bilemem.",
                                                "HÄ±mm, Ã¼zerinde biraz Ã§izik var ama satÄ±lÄ±r herhalde.",
                                                "Bunu daha Ã¶nce de gÃ¶rmÃ¼ÅŸtÃ¼m, Ã§ok da Ã¶zel deÄŸil.",
                                                "BakalÄ±m... Evet, bir alÄ±cÄ±sÄ± Ã§Ä±kar muhtemelen.",
                                                "Biraz tozlu, ama temizlenince fena durmaz.",
                                                "Fena deÄŸil, ama beni Ã§ok da heyecanlandÄ±rmadÄ±.",
                                                "Normal bir parÃ§a. BakalÄ±m kaÃ§a gider.",
                                                "Ä°ÅŸÃ§iliÄŸi fena deÄŸil, ama kondisyonu orta.",
                                                "Bunun ne olduÄŸunu tam anlayamadÄ±m, ama bakacaÄŸÄ±z."
                                ],
                                "suspicious": [
                                                "Bu ne ÅŸimdi? Ã‡Ã¶p mÃ¼ getirdin bana?",
                                                "Bunu kim, neden alsÄ±n ki? Ã‡ok kalitesiz duruyor.",
                                                "HÄ±mm, sanki bir yerleri eksik gibi. Beni mi dolandÄ±rÄ±yorsun?",
                                                "Bu sahteye benziyor, Ã¼zerinde seri numarasÄ± bile yok.",
                                                "Åu paslara bak, bunu bedava versen almam... belki.",
                                                "Kokusu bile kÃ¶tÃ¼, bunu depoda mÄ± sakladÄ±n laÄŸÄ±mda mÄ±?",
                                                "GerÃ§ekten buna para vereceÄŸimi mi sanÄ±yorsun?",
                                                "Bu kÄ±rÄ±k dÃ¶kÃ¼k ÅŸeyi bana neden gÃ¶steriyorsun?",
                                                "Sanki bunun Ã¼zerinde kan lekesi var... Nereden buldun bunu?",
                                                "Bunun orijinalliÄŸinden ciddi ÅŸÃ¼phelerim var."
                                ]
                },
                "lowball": {
                                "friendly": [
                                                "Dostum, biliyorsun masraflarÄ±m Ã§ok. Sana ancak bu kadar verebilirim.",
                                                "HatÄ±rÄ±m iÃ§in bu fiyata ver, bir sonrakinde telafi ederiz.",
                                                "Seni kÄ±rmak istemem ama dÃ¼kkanÄ±n da bir dÃ¶nmesi lazÄ±m.",
                                                "Bak, bu fiyat seni Ã¼zebilir ama piyasa bÃ¶yle maalesef.",
                                                "AramÄ±zdaki hukuka dayanarak sÃ¶ylÃ¼yorum, bu fiyat en iyisi.",
                                                "Hadi gel orta yolu bulalÄ±m, benim teklifim bu.",
                                                "BaÅŸkasÄ±ndan olsa daha az verirdim, sana kÄ±yaÄŸÄ±m bu olsun.",
                                                "GerÃ§ekten daha fazlasÄ±nÄ± vermek isterdim ama imkanlar kÄ±sÄ±tlÄ±.",
                                                "Hadi beni kÄ±rma, bu fiyata el sÄ±kÄ±ÅŸalÄ±m.",
                                                "Bu fiyatÄ± kabul et, akÅŸama sana bir yemek borcum olsun."
                                ],
                                "neutral": [
                                                "Teklifim bu, iÅŸine gelirse. BaÅŸkasÄ± bu kadar bile vermez.",
                                                "Piyasa fiyatÄ± bu, istersen gidip baÅŸkasÄ±na sor.",
                                                "Elimden gelenin en iyisi bu, daha fazlasÄ± beni kurtarmaz.",
                                                "Bak evlat, bu iÅŸler bÃ¶yle. Alacaksan al, satacaksan sat.",
                                                "Buna daha fazla vermek riskli, benim teklifim sabit.",
                                                "EkmeÄŸimin peÅŸindeyim, bu fiyat son fiyat.",
                                                "Daha fazlasÄ±nÄ± istersen kapÄ± orada.",
                                                "Bu eÅŸyanÄ±n modasÄ± geÃ§ti, ancak bu kadar eder.",
                                                "Nakiti seviyorsan bu parayÄ± al ve git.",
                                                "Ben de kar etmeliyim, deÄŸil mi?"
                                ],
                                "suspicious": [
                                                "Buna bu kadar bile Ã§ok ama, hadi neyse.",
                                                "Al ÅŸu parayÄ± ve kaybol gÃ¶zÃ¼mÃ¼n Ã¶nÃ¼nden.",
                                                "Bu hurdadan kurtulmak istiyorsan teklifim bu.",
                                                "Sana bir iyilik yapÄ±yorum, normalde kapÄ±dan sokmazdÄ±m.",
                                                "Åu parayÄ± al, yoksa polis Ã§aÄŸÄ±racaÄŸÄ±m.",
                                                "Bu Ã§Ã¶p iÃ§in bu kadar para vermem bile mucize.",
                                                "Daha fazlasÄ±nÄ± rÃ¼yanda gÃ¶rÃ¼rsÃ¼n.",
                                                "Seni dolandÄ±rÄ±cÄ± sanÄ±yordum ama meÄŸer sen safmÄ±ÅŸsÄ±n bu fiyata hayÄ±r dersen.",
                                                "Bu fiyata satmazsan git Ã§Ã¶pe at daha iyi.",
                                                "PazarlÄ±k payÄ± yok, ya al ya git."
                                ]
                },
                "accept": {
                                "friendly": [
                                                "Hah ÅŸÃ¶yle! Seninle iÅŸ yapmak her zaman bir keyif.",
                                                "El sÄ±kÄ±ÅŸtÄ±k mÄ±? Harika! Ä°ÅŸte dÃ¼rÃ¼st ticaret budur.",
                                                "Senin gibi tÃ¼ccarlar azaldÄ±, kÄ±ymetini bilmek lazÄ±m.",
                                                "TamamdÄ±r dostum, hayrÄ±nÄ± gÃ¶r paranÄ±n.",
                                                "GÃ¼zel anlaÅŸtÄ±k, bir sonraki sefere daha iyilerini bekliyorum.",
                                                "Ä°ÅŸte bu! Ä°ki taraf da kazandÄ±.",
                                                "Seni seviyorum be! Hadi git de biraz harca ÅŸu paralarÄ±.",
                                                "AnlaÅŸmak ne gÃ¼zel ÅŸey, deÄŸil mi?",
                                                "Tam istediÄŸim gibi oldu, teÅŸekkÃ¼rler.",
                                                "GÃ¼le gÃ¼le harca dostum."
                                ],
                                "neutral": [
                                                "Tamam, anlaÅŸtÄ±k. Al paranÄ±.",
                                                "GÃ¼zel, bir iÅŸi daha bitirdik.",
                                                "Makul bir anlaÅŸma oldu. Ver bakalÄ±m eÅŸyayÄ±.",
                                                "TamamdÄ±r, kaydÄ±nÄ± yapÄ±yorum.",
                                                "Ä°yi, hadi bakalÄ±m. SÄ±radaki!",
                                                "El sÄ±kÄ±ÅŸalÄ±m, bitsin bu iÅŸ.",
                                                "Fena deÄŸil, iki taraf iÃ§in de adil.",
                                                "Tamam, Ã¶demeni yapÄ±yorum.",
                                                "Ä°ÅŸlem tamamdÄ±r.",
                                                "HayÄ±rlÄ± olsun."
                                ],
                                "suspicious": [
                                                "Nihayet... Al ÅŸu parayÄ± ve defol.",
                                                "Sonunda akÄ±llandÄ±n. Ver ÅŸunu bana.",
                                                "Tamam, git ÅŸimdi. GÃ¶zÃ¼m gÃ¶rmesin seni.",
                                                "Ä°stediÄŸin oldu, ama bir dahakine bu kadar ÅŸanslÄ± olmayacaksÄ±n.",
                                                "Al paranÄ±, saymayÄ± da unutma.",
                                                "Ã‡abuk ver eÅŸyayÄ± ve Ã§Ä±k dÄ±ÅŸarÄ±.",
                                                "Seninle iÅŸ yapmak baÅŸ aÄŸrÄ±sÄ± resmen.",
                                                "Neyse ki bitti. Kaybol ÅŸimdi.",
                                                "Sonunda el sÄ±kÄ±ÅŸabildik, ne zor adammÄ±ÅŸsÄ±n.",
                                                "Git hadi, dÃ¼kkanÄ±n havasÄ± deÄŸiÅŸsin."
                                ]
                },
                "reject": {
                                "friendly": [
                                                "Yapma dostum, beni batÄ±rmak mÄ± istiyorsun?",
                                                "GÃ¼ldÃ¼rme beni, o fiyata ancak hayallerinde satarsÄ±n.",
                                                "Seni severim ama o kadar da deÄŸil! Ä°mkansÄ±z.",
                                                "Yok artÄ±k! DÃ¼kkanÄ±n anahtarÄ±nÄ± da vereyim istersen?",
                                                "Åaka yapÄ±yorsun herhalde, deÄŸil mi? GerÃ§ek fiyatÄ± sÃ¶yle.",
                                                "Dostuz dedik ama sen beni soymaya Ã§alÄ±ÅŸÄ±yorsun.",
                                                "Bu fiyata verirsem eÅŸim beni eve almaz!",
                                                "HayÄ±r hayÄ±r, kesinlikle olmaz. BaÅŸka kapÄ±ya.",
                                                "Beni hayal kÄ±rÄ±klÄ±ÄŸÄ±na uÄŸrattÄ±n, daha makul bir ÅŸey sÃ¶yle.",
                                                "O fiyata bunu ancak mÃ¼zeye satarsÄ±n."
                                ],
                                "neutral": [
                                                "Dalga mÄ± geÃ§iyorsun? Git iÅŸine.",
                                                "Bu fiyatla ancak kendini kandÄ±rÄ±rsÄ±n.",
                                                "Beni aptal mÄ± sandÄ±n? O fiyat imkansÄ±z.",
                                                "PazarlÄ±k dedik ama seninki resmen soygun.",
                                                "Hadi ordan! O kadar etmez bu.",
                                                "Kendine baÅŸka bir kurban bul, ben o fiyatÄ± yemem.",
                                                "CiddileÅŸince gel, yoksa vaktimi harcama.",
                                                "Bu dÃ¼kkanda Ã¶yle fiyatlar sÃ¶kmez.",
                                                "HayÄ±r, teklifim son. Ä°stersen git baÅŸkasÄ±na sat.",
                                                "ZamanÄ±mÄ± boÅŸa harcÄ±yorsun."
                                ],
                                "suspicious": [
                                                "Defol git dÃ¼kkanÄ±mdan! Ã‡abuk!",
                                                "Seni dolandÄ±rÄ±cÄ±! Polis Ã§aÄŸÄ±rmamÄ± istemiyorsan hemen Ã§Ä±k.",
                                                "Beni kazÄ±klayabileceÄŸini mi sandÄ±n? Defol!",
                                                "SabrÄ±m bitti. Ã‡Ä±k dÄ±ÅŸarÄ±!",
                                                "Seninle geÃ§irdiÄŸim her saniye zarar. Git!",
                                                "Bu ne kÃ¼stahlÄ±k! Hemen terket burayÄ±.",
                                                "Bir daha sakÄ±n bu kapÄ±dan iÃ§eri girme.",
                                                "Senin gibi tipleri Ã§ok gÃ¶rdÃ¼m ben. YÃ¼rÃ¼!",
                                                "Seni ciddiye alanda kabahat. Defol!",
                                                "Kaybol yoksa fena olacak!"
                                ]
                },
                "threatResponse": [
                                "Beni tehdit etme, zararlÄ± Ã§Ä±karsÄ±n.",
                                "Cesaretini takdir ettim ama aptallÄ±ÄŸÄ±nÄ± deÄŸil.",
                                "Tamam tamam, sakin ol. Belki bir ÅŸeyler yapabiliriz.",
                                "Dostum burasÄ± Teksas deÄŸil, indir o kaÅŸlarÄ±nÄ±.",
                                "Bana baÄŸÄ±rma, sesin dÃ¼kkanÄ±n dÄ±ÅŸÄ±na Ã§Ä±kÄ±yor.",
                                "Tehditler bana sÃ¶kmez ama pazarlÄ±k yapabiliriz.",
                                "Bu ne sinir? Biraz sakinleÅŸ de konuÅŸalÄ±m.",
                                "Beni korkutabileceÄŸini mi sandÄ±n? Komik olma.",
                                "Sakin ol, tansiyonun Ã§Ä±kacak. Gel anlaÅŸalÄ±m.",
                                "Tehdit yerine teklif sunsan daha Ã§ok iÅŸine yarar."
                ],
                "consulting_start": {
                                "friendly": [
                                                "Senden bu kadar kaliteli bir ÅŸey Ã§Ä±kmaz ama, neyse... Gidip bir ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim.",
                                                "Tipine bakÄ±nca dolandÄ±rÄ±cÄ± gibisin ama mal gerÃ§ek gibi. Dur bi ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim.",
                                                "Bunu Ã§Ã¶pten bulmadÄ±ÄŸÄ±na emin misin? Bekle, ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim.",
                                                "Bu Ã§ok deÄŸerli gÃ¶rÃ¼nÃ¼yor dostum. Bir uzmana gÃ¶stersem iyi olur, ${itemName} uzmanÄ±mÄ± arayayÄ±m.",
                                                "Vay canÄ±na, bu gerÃ§ekse servet eder. Hemen ${itemName} uzmanÄ±ma soruyorum."
                                ],
                                "neutral": [
                                                "Bunu bir ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim. Bekle burada.",
                                                "Bir dakka, ÅŸunu hemen ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geliyorum.",
                                                "Bekle biraz, ÅŸunu bi ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim.",
                                                "Uzman gÃ¶rÃ¼ÅŸÃ¼ ÅŸart. ${itemName} uzmanÄ±mÄ± Ã§aÄŸÄ±rayÄ±m.",
                                                "Buna tek baÅŸÄ±ma deÄŸer biÃ§emem. ${itemName} uzmanÄ±ma danÄ±ÅŸmalÄ±yÄ±m."
                                ],
                                "suspicious": [
                                                "GÃ¶zÃ¼m seni hiÃ§ tutmadÄ±. Bu ${itemName} uzmanÄ±ma gÃ¶stermeden almam.",
                                                "EÄŸer sahteyse baÅŸÄ±n derde girer. Gidip ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim.",
                                                "MalÄ±na gÃ¼venmiyorum, sana hiÃ§ gÃ¼venmiyorum. Mecburen ${itemName} uzmanÄ±ma danÄ±ÅŸÄ±p geleyim.",
                                                "Bu kesin sahtedir ama yine de ${itemName} uzmanÄ±ma soracaÄŸÄ±m.",
                                                "DolandÄ±rmaya Ã§alÄ±ÅŸÄ±yorsan uzmanÄ±m hemen anlar. ${itemName} uzmanÄ±ma gidiyorum."
                                ]
                },
                "consulting_end": {
                                "friendly": [
                                                "ArkadaÅŸÄ±m baktÄ±, sorun yokmuÅŸ. ÅaÅŸÄ±rtÄ±cÄ±... Hadi fiyatÄ± konuÅŸalÄ±m.",
                                                "TamamdÄ±r, onay verdi. Hadi yine iyisin.",
                                                "UzmanÄ±m 'bu bir harika' dedi. ÅansÄ±n yaver gitti.",
                                                "OnayÄ± aldÄ±k, mal saÄŸlammÄ±ÅŸ. PazarlÄ±ÄŸa dÃ¶nebiliriz."
                                ],
                                "neutral": [
                                                "UzmanÄ±m inceledi. TamamdÄ±r, pazarlÄ±ÄŸa geÃ§elim.",
                                                "Geldim. UzmanÄ±mla konuÅŸtum, bir sÄ±kÄ±ntÄ± yok.",
                                                "OnaylandÄ±. DeÄŸeri konusunda artÄ±k daha netiz.",
                                                "Ä°nceleme bitti, her ÅŸey yolunda gÃ¶rÃ¼nÃ¼yor."
                                ],
                                "suspicious": [
                                                "UzmanÄ±m gerÃ§ek dedi ama benim hala ÅŸÃ¼phelerim var. Neyse.",
                                                "Åimdilik inandÄ±m say. Ama gÃ¶zÃ¼m Ã¼zerinde.",
                                                "Sahte Ã§Ä±kmadÄ± ama bir dahakine bu kadar ÅŸanslÄ± olmayabilirsin.",
                                                "Onay aldÄ± ama hala iÃ§ime sinmedi. Neyse, konuÅŸalÄ±m."
                                ]
                }
},

            getLine: function(category, reputation) {
                // If the category is threatResponse (array), return directly
                if (Array.isArray(this.dialogue[category])) {
                    const lines = this.dialogue[category];
                    return lines[Math.floor(Math.random() * lines.length)];
                }

                let tier = 'neutral';
                if (reputation > 70) tier = 'friendly';
                else if (reputation < 30) tier = 'suspicious';

                const lines = this.dialogue[category][tier];
                return lines[Math.floor(Math.random() * lines.length)];
            },

            // Logic to determine initial offer (always lowball)
            calculateOffer: function(itemRealValue, reputation) {
                // Base offer is 40-60% of real value
                let percent = 0.4 + (Math.random() * 0.2);

                // Reputation bonus
                if (reputation > 70) percent += 0.15; // Better offers for friends
                if (reputation < 30) percent -= 0.15; // Worse for suspicious

                return Math.floor(itemRealValue * percent);
            }
        };

        // --- STATE ---
        let gameState = {
            money: GAME_CONFIG.startMoney,
            round: 1,
            reputation: 50, // 0-100, 50 is neutral
            inventory: [],
            currentUnit: null,
            history: [],
            gameOver: false,
            eoPatience: 4, // Max 4 per round
            negotiationMemory: {}, // Remembers offers per item
            auction: null, // Active auction state
            // NEW FIELDS
            xp: 0,
            level: 1,
            skillPoints: 0,
            skills: {
                xray: 0,
                silverTongue: 0,
                restorer: 0,
                hoarder: 0
            },
            quests: [], // Active quests
            inventoryLimit: 10,
            storageLevel: 1
        };

        // --- DOM ELEMENTS ---
        const ui = {
            app: document.getElementById('app'),
            money: document.getElementById('ui-money'),
            round: document.getElementById('ui-round'),
            rep: document.getElementById('ui-reputation')
        };

        // --- INIT ---
        window.onload = () => {
            initGame();
        };

        function initGame() {
            console.log("Oyun BaÅŸlatÄ±ldÄ±.");
            updateHeader();
            startRound();
        }

        function updateHeader() {
            ui.money.innerText = gameState.money.toLocaleString('tr-TR') + ' â‚º';
            ui.round.innerText = gameState.round;

            let repText = "NÃ¶tr";
            if (gameState.reputation > 70) repText = "Dost";
            else if (gameState.reputation > 85) repText = "Ortak";
            else if (gameState.reputation < 30) repText = "ÅÃ¼pheli";
            else if (gameState.reputation < 15) repText = "DÃ¼ÅŸman";

            ui.rep.innerText = repText;
            ui.rep.style.color = gameState.reputation < 30 ? 'var(--danger-color)' : (gameState.reputation > 70 ? 'var(--success-color)' : 'var(--text-color)');
        }

        // --- GAME LOGIC ---

        // XP SYSTEM
        function addXp(amount) {
            gameState.xp += amount;
            const xpNeeded = gameState.level * 1000;
            if (gameState.xp >= xpNeeded) {
                gameState.level++;
                gameState.xp -= xpNeeded;
                gameState.skillPoints++;
                alert(`ğŸ‰ TEBRÄ°KLER! Seviye AtladÄ±n! Yeni Seviye: ${gameState.level}. +1 Yetenek PuanÄ± kazandÄ±n.`);
            }
            updateHeader();
        }

        // QUEST SYSTEM
        function generateQuests() {
            gameState.quests = [];
            const questCount = 2 + Math.floor(Math.random() * 2); // 2 or 3
            const categories = ["Elektronik", "Antika", "Giyim", "Mobilya", "Spor"];

            for(let i=0; i<questCount; i++) {
                const isSellQuest = Math.random() > 0.5;
                if (isSellQuest) {
                    const type = Math.random() > 0.7 ? 'rare' : 'common';
                    const targetCount = 1 + Math.floor(Math.random() * 2);
                    const rewardMult = type === 'rare' ? 2 : 1;
                    gameState.quests.push({
                        id: Date.now() + i,
                        text: `${targetCount} adet ${type === 'rare' ? 'Nadir' : 'SÄ±radan'} eÅŸya sat`,
                        type: 'sell_rarity',
                        target: type,
                        count: targetCount,
                        current: 0,
                        rewardMoney: 500 * targetCount * rewardMult,
                        rewardXp: 100 * targetCount * rewardMult
                    });
                } else {
                    const cat = categories[Math.floor(Math.random() * categories.length)];
                    const targetCount = 1 + Math.floor(Math.random() * 2);
                    gameState.quests.push({
                        id: Date.now() + i,
                        text: `${targetCount} adet ${cat} kategorisinde eÅŸya sat`,
                        type: 'sell_category',
                        target: cat,
                        count: targetCount,
                        current: 0,
                        rewardMoney: 400 * targetCount,
                        rewardXp: 80 * targetCount
                    });
                }
            }
        }

        function checkQuestProgress(item) {
            let completedAny = false;
            gameState.quests.forEach(q => {
                if (q.completed) return;

                let match = false;
                if (q.type === 'sell_rarity' && item.type === q.target) match = true;
                if (q.type === 'sell_category' && item.category === q.target) match = true;

                if (match) {
                    q.current++;
                    if (q.current >= q.count) {
                        q.completed = true;
                        gameState.money += q.rewardMoney;
                        addXp(q.rewardXp);
                        alert(`âœ… GÃ–REV TAMAMLANDI: ${q.text}\nÃ–dÃ¼l: ${q.rewardMoney}â‚º, ${q.rewardXp} XP`);
                        completedAny = true;
                    }
                }
            });
            if(completedAny) updateHeader();
        }

        function startRound() {
            gameState.availableUnits = generateStorageUnits();
            generateQuests(); // New quests every round

            // Determine Patience based on Reputation
            if (gameState.reputation > 70) gameState.eoPatience = 4;
            else if (gameState.reputation < 30) gameState.eoPatience = 2;
            else gameState.eoPatience = 3;

            gameState.negotiationMemory = {};

            // Check for Game Over (Bankruptcy)
            // If the player cannot afford the cheapest unit, they are done.
            const cheapestUnit = Math.min(...gameState.availableUnits.map(u => u.price));

            if (gameState.money < cheapestUnit) {
                renderGameOver();
            } else {
                renderStorageSelection();
            }
        }

        function renderGameOver() {
            ui.app.innerHTML = `
                <div class="screen screen-glass">
                    <h1 style="color: var(--danger-color)">ğŸš« Ä°FLAS ETTÄ°N</h1>
                    <div style="font-size:3rem; margin:20px;">ğŸ’¸</div>
                    <p>Cebinde kalan para: <span class="money">${gameState.money} â‚º</span></p>
                    <div class="speech-bubble" style="margin:20px auto; color:#333;">EO: "ÃœzgÃ¼nÃ¼m dostum, burasÄ± hayÄ±r kurumu deÄŸil. BaÅŸka kapÄ±ya."</div>
                    <p>UlaÅŸÄ±lan Tur: ${gameState.round}</p>
                    <button class="btn" onclick="location.reload()">ğŸ”„ TEKRAR DENE</button>
                </div>
            `;
        }

        function generateStorageUnits() {
            const units = [];
            const risks = ['DÃ¼ÅŸÃ¼k', 'Orta', 'YÃ¼ksek'];

            for(let i=0; i<5; i++) {
                // Black Market Chance (3%)
                let isBlackMarket = Math.random() < 0.03;

                let riskLevel, riskLabel, name, desc, className;
                let estimatedMin, estimatedMax;

                if (isBlackMarket) {
                    riskLevel = 3; // Special ID for Black Market
                    riskLabel = "KARA BORSA";
                    name = `Depo #${100 + i + (gameState.round * 5)} (KARA BORSA)`;
                    className = "black-market";
                    desc = "KÄ±rmÄ±zÄ± bir Ä±ÅŸÄ±k yayÄ±yor... Ä°Ã§erisi tehlikeli gÃ¶rÃ¼nÃ¼yor.";

                    let baseVal = 15000 + (gameState.round * 2000);
                    // Black market estimate is always huge range
                    estimatedMin = Math.floor(baseVal * 0.5);
                    estimatedMax = Math.floor(baseVal * 3.0);

                } else {
                    riskLevel = Math.floor(Math.random() * 3); // 0, 1, 2
                    riskLabel = risks[riskLevel];
                    name = `Depo #${100 + i + (gameState.round * 5)}`;
                    className = "";
                    desc = generateUnitDescription(riskLevel);

                    let baseVal = 500 + (gameState.round * 50);
                    if(riskLevel === 1) baseVal *= 1.5;
                    if(riskLevel === 2) baseVal *= 2.5;

                    // Accuracy Logic
                    if (riskLevel === 0) { // Low Risk: Accurate
                        estimatedMin = Math.floor(baseVal * 0.9);
                        estimatedMax = Math.floor(baseVal * 1.1);
                    } else if (riskLevel === 1) { // Med Risk: Balanced
                        estimatedMin = Math.floor(baseVal * 0.7);
                        estimatedMax = Math.floor(baseVal * 1.4);
                    } else { // High Risk: Wild
                        estimatedMin = Math.floor(baseVal * 0.4);
                        estimatedMax = Math.floor(baseVal * 2.5);
                    }
                }

                units.push({
                    id: i,
                    name: name,
                    risk: riskLevel,
                    riskLabel: riskLabel,
                    estimatedMin: estimatedMin,
                    estimatedMax: estimatedMax,
                    description: desc,
                    className: className,
                    soldTo: null // Tracks if AI bought it
                });
            }
            return units;
        }

        function generateUnitDescription(risk) {
            const descs = [
                ["Temiz gÃ¶rÃ¼nÃ¼yor.", "BirkaÃ§ koli var.", "Standart ev eÅŸyalarÄ±."], // Low
                ["KarÄ±ÅŸÄ±k bir yÄ±ÄŸÄ±n.", "BazÄ± kutular kapalÄ±.", "Tozlu ama dolu."], // Med
                ["Tam bir muamma.", "Ya hazine ya Ã§Ã¶p.", "AÄŸÄ±r kutular var."] // High
            ];
            return descs[risk][Math.floor(Math.random() * descs[risk].length)];
        }

        // --- AUCTION SYSTEM ---

        window.startAuction = function(unitId) {
            const unit = gameState.availableUnits.find(u => u.id === unitId);
            if (!unit) return;

            // Initialize Auction State
            const startBid = Math.floor((unit.estimatedMin + unit.estimatedMax) / 2 * 0.5);

            gameState.auction = {
                unit: unit,
                currentBid: startBid,
                highestBidder: null, // null = no one yet (or house)
                timer: 0, // 0=Waiting, 1=Going Once, 2=Going Twice, 3=Sold
                timerInterval: null,
                participants: OPPONENTS.map(op => ({
                    ...op,
                    isFolded: false,
                    lastAction: null // 'bid', 'pass', 'wait'
                })),
                log: [`Ä°hale baÅŸladÄ±! BaÅŸlangÄ±Ã§ fiyatÄ±: ${startBid} â‚º`],
                playerFolded: false,
                lastBidTime: Date.now(),
                lastLogIndex: 0
            };

            setupAuctionUI();

            // Start the loop
            if (gameState.auction.timerInterval) clearInterval(gameState.auction.timerInterval);
            gameState.auction.timerInterval = setInterval(updateAuctionLoop, 1000);
        };

        function setupAuctionUI() {
            const auc = gameState.auction;
            const unit = auc.unit;

            // Participants HTML
            const opponentsHtml = auc.participants.map(p => {
                return `
                <div id="opponent-card-${p.id}" class="opponent-card" style="--char-color: ${p.color}">
                    <div class="opponent-avatar">${p.avatar}</div>
                    <div class="opponent-name">${p.name}</div>
                    <div id="leader-badge-${p.id}" style="font-size:0.7rem; color:var(--char-color); font-weight:bold; display:none;">LÄ°DER</div>
                </div>
                `;
            }).join('');

            ui.app.innerHTML = `
                <div class="screen screen-glass" style="max-width:1000px">
                    <div class="auction-header">
                        <div>
                            <h2 style="margin:0">${unit.name}</h2>
                            <div style="font-size:0.9rem; opacity:0.7">Tahmini: ${unit.estimatedMin} - ${unit.estimatedMax} â‚º</div>
                        </div>
                        <div class="money">${gameState.money} â‚º</div>
                    </div>

                    <div class="auction-main">
                        <div class="auction-visual">
                            <div style="font-size:1.2rem; color:#aaa; margin-bottom:10px;">GÃœNCEL TEKLÄ°F</div>
                            <div id="auction-current-bid" class="current-bid-display">${auc.currentBid} â‚º</div>
                            <div id="auction-timer-text" class="timer-display">Teklif Bekleniyor...</div>
                            <div id="player-win-msg" style="color:var(--success-color); font-weight:bold; margin-top:10px; display:none;">ğŸ† ÅU AN KAZANIYORSUN!</div>
                        </div>

                        <div class="opponents-grid">
                            ${opponentsHtml}
                            <!-- Player Card -->
                            <div id="opponent-card-player" class="opponent-card" style="--char-color: #00e676">
                                <div class="opponent-avatar">ğŸ‘¤</div>
                                <div class="opponent-name">SEN</div>
                                <div id="leader-badge-player" style="font-size:0.7rem; color:var(--success-color); font-weight:bold; display:none;">LÄ°DER</div>
                            </div>
                        </div>

                        <div class="bid-log" id="auction-log">
                            <div class="log-entry">${auc.log[0]}</div>
                        </div>

                        <div class="player-controls">
                            <button id="btn-bid-50" class="btn" onclick="placePlayerBid(50)">+50 â‚º</button>
                            <button id="btn-bid-200" class="btn" onclick="placePlayerBid(200)">+200 â‚º</button>
                            <button id="btn-fold" class="btn btn-danger" onclick="playerFold()">Ã‡EKÄ°L ğŸ³ï¸</button>
                        </div>
                    </div>
                </div>
            `;

            // Set initial lastLogIndex
            auc.lastLogIndex = 1;
        }

        function updateAuctionUI() {
            const auc = gameState.auction;
            if(!auc) return;

            // Update Bid Text
            document.getElementById('auction-current-bid').innerText = auc.currentBid + ' â‚º';

            // Update Timer Text
            let timerText = "Teklif Bekleniyor...";
            if (auc.timer === 1) timerText = "SATILIYOR... (1)";
            if (auc.timer === 2) timerText = "SATILIYOR... (2)";
            if (auc.timer === 3) timerText = "SATILDI!";
            document.getElementById('auction-timer-text').innerText = timerText;

            // Update Participants Visuals
            auc.participants.forEach(p => {
                const card = document.getElementById(`opponent-card-${p.id}`);
                const badge = document.getElementById(`leader-badge-${p.id}`);

                if (card) {
                    // Classes
                    if (p.isFolded) {
                        card.classList.add('folded');
                        card.classList.remove('active-bidder');
                    } else if (auc.highestBidder && auc.highestBidder.id === p.id) {
                        card.classList.add('active-bidder');
                        card.classList.remove('folded');
                    } else {
                        card.classList.remove('active-bidder', 'folded');
                    }
                }

                if (badge) {
                    badge.style.display = (auc.highestBidder && auc.highestBidder.id === p.id) ? 'block' : 'none';
                }
            });

            // Update Player Visuals
            const pCard = document.getElementById('opponent-card-player');
            const pBadge = document.getElementById('leader-badge-player');
            const pWinMsg = document.getElementById('player-win-msg');
            const isPlayerLeader = auc.highestBidder && auc.highestBidder.id === 'player';

            if (pCard) {
                if (auc.playerFolded) {
                    pCard.classList.add('folded');
                    pCard.classList.remove('active-bidder');
                } else if (isPlayerLeader) {
                    pCard.classList.add('active-bidder');
                    pCard.classList.remove('folded');
                } else {
                    pCard.classList.remove('active-bidder', 'folded');
                }
            }

            if (pBadge) pBadge.style.display = isPlayerLeader ? 'block' : 'none';
            if (pWinMsg) pWinMsg.style.display = isPlayerLeader ? 'block' : 'none';

            // Update Buttons
            const canBid = !auc.playerFolded && gameState.money >= (auc.currentBid + 50) && auc.timer < 3;
            document.getElementById('btn-bid-50').disabled = !canBid;
            document.getElementById('btn-bid-200').disabled = !canBid;
            document.getElementById('btn-fold').disabled = (auc.playerFolded || auc.timer >= 3);

            // Update Log (Append only)
            const logContainer = document.getElementById('auction-log');
            if (logContainer && auc.lastLogIndex < auc.log.length) {
                for (let i = auc.lastLogIndex; i < auc.log.length; i++) {
                    const entry = auc.log[i];
                    const isHigh = entry.includes('teklif');
                    const isFold = entry.includes('Ã§ekildi');
                    const className = isHigh ? 'high-bid' : (isFold ? 'fold' : '');

                    const div = document.createElement('div');
                    div.className = `log-entry ${className}`;
                    div.innerText = entry;
                    logContainer.appendChild(div);
                }
                auc.lastLogIndex = auc.log.length;
                logContainer.scrollTop = logContainer.scrollHeight;
            }
        }

        function showSpeech(id, type) {
            const linesObj = OPPONENT_LINES[id];
            if (!linesObj) return;

            const lines = linesObj[type];
            if (!lines || lines.length === 0) return;

            const text = lines[Math.floor(Math.random() * lines.length)];

            const card = document.getElementById(`opponent-card-${id}`);
            if (!card) return;

            // Remove existing bubble if any
            const existing = card.querySelector('.mini-bubble');
            if (existing) existing.remove();

            // Determine Position (Zig-Zag)
            // Yilong (0) -> Top, Hasan (1) -> Bottom, Daniel (2) -> Top, Cilem (3) -> Bottom
            const opIndex = OPPONENTS.findIndex(o => o.id === id);
            const isTop = (opIndex === -1) ? true : (opIndex % 2 === 0);
            const posClass = isTop ? 'bubble-top' : 'bubble-bottom';

            const bubble = document.createElement('div');
            bubble.className = `mini-bubble ${posClass}`;
            bubble.innerText = text;

            card.appendChild(bubble);

            setTimeout(() => {
                bubble.style.opacity = '0';
                setTimeout(() => bubble.remove(), 300);
            }, 3000);
        }

        window.placePlayerBid = function(amount) {
            const auc = gameState.auction;
            if(!auc || auc.playerFolded) return;

            const nextBid = auc.currentBid + amount;
            if(gameState.money < nextBid) {
                alert("Yetersiz bakiye!");
                return;
            }

            placeBid('player', nextBid);
        };

        window.playerFold = function() {
            const auc = gameState.auction;
            if(!auc) return;

            auc.playerFolded = true;
            // Immediate exit: clear interval, mark sold, and return to hub
            if (auc.timerInterval) clearInterval(auc.timerInterval);
            auc.unit.soldTo = { name: "Anonim AlÄ±cÄ±" };
            gameState.auction = null;
            renderStorageSelection();
        };

        function updateAuctionLoop() {
            const auc = gameState.auction;
            if(!auc) return;

            // Timer Logic
            const now = Date.now();
            const timeSinceLastBid = now - auc.lastBidTime;

            if (timeSinceLastBid > 9000) {
                auc.timer = 3; // SOLD
                updateAuctionUI(); // Final update
                clearInterval(auc.timerInterval);
                setTimeout(endAuction, 500); // Small delay to see SOLD state
            } else if (timeSinceLastBid > 6000) {
                auc.timer = 2; // Going Twice
            } else if (timeSinceLastBid > 3000) {
                auc.timer = 1; // Going Once
            } else {
                auc.timer = 0; // Waiting
            }

            // Random Speech Chance (Idle)
            if (Math.random() < 0.05) { // 5% per second
                const active = auc.participants.filter(p => !p.isFolded);
                if (active.length > 0) {
                    const speaker = active[Math.floor(Math.random() * active.length)];
                    showSpeech(speaker.id, 'random');
                }
            }

            // Process AI (if not sold)
            if (auc.timer < 3) {
                 processAIBidding();
            }

            updateAuctionUI();
        }

        function processAIBidding() {
            const auc = gameState.auction;
            // Only one AI bids per tick max to avoid chaos, or random chance
            if (Math.random() < 0.6) return; // 60% chance no one acts this tick

            // Shuffle participants to randomise order
            const activeAI = auc.participants.filter(p => !p.isFolded && p.id !== (auc.highestBidder ? auc.highestBidder.id : ''));
            if (activeAI.length === 0) return;

            const ai = activeAI[Math.floor(Math.random() * activeAI.length)];

            // Decision Logic
            const unit = auc.unit;

            if (!ai.perceivedLimit) {
                // Initialize limit once
                let estimateAvg = (unit.estimatedMin + unit.estimatedMax) / 2;
                let riskFactor = 1;
                if (unit.risk === 1) riskFactor = 1.2;
                if (unit.risk === 2) riskFactor = 1.5;
                if (unit.risk === 3) riskFactor = 2.0; // Black market

                switch(ai.id) {
                    case 'yilong': // Crazy, rich, troll
                        ai.perceivedLimit = unit.estimatedMax * (1 + Math.random() * 2);
                        break;
                    case 'hasan': // Scrap dealer, very conservative
                        ai.perceivedLimit = unit.estimatedMin * (0.8 + Math.random() * 0.3);
                        break;
                    case 'daniel': // Smart, calculates margin
                        ai.perceivedLimit = unit.estimatedMax * 0.8;
                        break;
                    case 'cilem': // Pessimist, poor
                        ai.perceivedLimit = unit.estimatedMin * (0.5 + Math.random() * 0.4);
                        break;
                }
            }

            // Logic to Bid or Fold
            const nextMinBid = auc.currentBid + 50;

            // Check budget
            if (nextMinBid > ai.wealth) {
                ai.isFolded = true;
                auc.log.push(`${ai.avatar} ${ai.name} parasÄ±zlÄ±ktan Ã§ekildi.`);
                showSpeech(ai.id, 'fold');
                return;
            }

            // Check Limit
            if (nextMinBid > ai.perceivedLimit) {
                // Yilong might troll and go over limit sometimes (10%)
                if (ai.id === 'yilong' && Math.random() < 0.1) {
                     // Troll bid
                } else {
                    ai.isFolded = true;
                    auc.log.push(`${ai.avatar} ${ai.name} Ã§ekildi.`);
                    showSpeech(ai.id, 'fold');
                    return;
                }
            }

            // Yilong "Wait" Logic
            if (ai.id === 'yilong' && Math.random() < 0.3) {
                return;
            }

            // Place Bid
            let increment = 50;
            if (ai.aggressive > 0.5 && Math.random() < 0.5) increment = 200;
            if (ai.id === 'yilong' && Math.random() < 0.2) increment = 500;

            placeBid(ai.id, auc.currentBid + increment);
        }

        function placeBid(bidderId, amount) {
            const auc = gameState.auction;
            if(auc.timer >= 3) return; // Closed

            // Update State
            auc.currentBid = amount;

            if (bidderId === 'player') {
                auc.highestBidder = { id: 'player', name: 'SEN' };
                auc.log.push(`ğŸ‘¤ SEN ${amount} â‚º teklif verdin!`);
            } else {
                const ai = auc.participants.find(p => p.id === bidderId);
                auc.highestBidder = ai;
                auc.log.push(`${ai.avatar} ${ai.name} ${amount} â‚º teklif verdi!`);

                showSpeech(ai.id, 'bid');
            }

            // Reset Timer
            auc.lastBidTime = Date.now();
            auc.timer = 0;

            // Immediate UI update for responsiveness
            updateAuctionUI();
        }

        function endAuction() {
            const auc = gameState.auction;
            const winner = auc.highestBidder;

            if (winner && winner.id === 'player') {
                // Player Won
                if (gameState.money >= auc.currentBid) {
                    completePlayerPurchase(auc.unit, auc.currentBid);
                } else {
                    alert("Hata: Yetersiz Bakiye!");
                    renderStorageSelection();
                }
            } else if (winner) {
                // AI Won
                alert(`Ä°haleyi ${winner.name} kazandÄ±! Fiyat: ${auc.currentBid} â‚º`);
                auc.unit.soldTo = winner;
                renderStorageSelection();
            } else {
                alert("Kimse teklif vermedi. Ä°hale iptal.");
                renderStorageSelection();
            }
            gameState.auction = null;
        }

        function completePlayerPurchase(unit, finalPrice) {
            gameState.money -= finalPrice;
            gameState.currentUnit = unit;
            updateHeader();

            // Generate items
            const newItems = generateItemsForUnit(unit);
            gameState.inventory.push(...newItems);

            // Remove unit from available list? Or mark as sold to player?
            // Original logic removed it from "availableUnits" implicitly by regenerating or just showing the reveal screen.
            // But if we want to return to the list later, we should mark it.
            // However, the game flow is: Buy -> Reveal -> Hub. So we don't need to persist it in the list for this round usually.
            // But let's follow the standard 'revealItems' flow which replaces the screen.

            revealItems(newItems);
        }

        function renderStorageSelection() {
            const containerHtml = gameState.availableUnits.map(unit => {
                let riskClass;
                if(unit.risk === 3) riskClass = 'risk-black';
                else riskClass = unit.risk === 0 ? 'risk-low' : (unit.risk === 1 ? 'risk-med' : 'risk-high');

                const isSold = unit.soldTo !== null;
                // Min start bid is approx 50% of avg estimate, checking afford based on that
                const startBid = Math.floor((unit.estimatedMin + unit.estimatedMax) / 2 * 0.5);
                const canAfford = gameState.money >= startBid;

                let cardContent = `
                    <h3>${unit.name}</h3>
                    <p>${unit.description}</p>
                    <div class="risk-badge ${riskClass}">Risk: ${unit.riskLabel}</div>
                    <div class="unit-price" style="margin-top:auto; font-size:1.1rem; color:#ccc;">
                        Tahmini: <span style="color:var(--accent-color); font-weight:bold;">${unit.estimatedMin} - ${unit.estimatedMax} â‚º</span>
                    </div>
                `;

                let clickAction = "";
                let cardStyle = "";

                if (isSold) {
                    cardContent += `<div style="margin-top:10px; color:var(--danger-color); font-weight:bold; border:2px solid var(--danger-color); padding:5px; border-radius:5px; transform:rotate(-5deg);">SATILDI: ${unit.soldTo.name}</div>`;
                    cardStyle = "opacity:0.6; filter:grayscale(0.8); cursor:default;";
                } else {
                    if (canAfford) {
                        clickAction = `onclick="startAuction(${unit.id})"`;
                    } else {
                        cardStyle = "opacity:0.5; cursor:not-allowed;";
                    }
                }

                return `
                <div class="storage-card ${unit.className}" ${clickAction} style="${cardStyle}">
                    ${cardContent}
                </div>
                `;
            }).join('');

            ui.app.innerHTML = `
                <div class="screen">
                    <h2 style="font-size:2rem; margin-bottom:10px">ğŸ“¢ GÃœNÃœN Ä°HALESÄ°</h2>
                    <p style="color:#aaa">Mevcut Bakiye: <span class="money">${gameState.money} â‚º</span></p>
                    <div class="storage-grid">
                        ${containerHtml}
                    </div>
                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                </div>
            `;
        }

        // --- EXPERT PHASE ---

        window.startExpertPhase = function() {
            renderExpert();
        };

        function renderExpert() {
             const listHtml = gameState.inventory.map(item => {
                let rarityInfo = Object.values(RARITY).find(r => r.id === item.type);
                const fee = Math.max(50, Math.floor(item.realValue * 0.05));
                const canAfford = gameState.money >= fee;

                return `
                <div class="item-row rarity-${item.type}">
                    <div>
                        <strong>${item.name}</strong> ${item.certified ? 'âœ…' : ''}<br>
                        <span style="color:${rarityInfo.color}; font-size:0.8rem">${rarityInfo.label}</span>
                    </div>
                    <div style="display:flex; align-items:center; gap:10px;">
                        ${item.certified
                            ? `<span style="color:var(--success-color); font-weight:bold;">DEÄER: ${item.realValue} â‚º</span>`
                            : `<button class="btn" style="font-size:0.8rem" onclick="certifyItem(${item.id}, ${fee})" ${!canAfford ? 'disabled' : ''}>ONAYLAT (-${fee}â‚º)</button>`
                        }
                    </div>
                </div>
                `;
            }).join('');

            ui.app.innerHTML = `
                <div class="screen screen-glass">
                    <h2>ğŸ§ EKSPERTÄ°Z BÃœROSU</h2>
                    <p>Burada ÅŸÃ¼pheli eÅŸyalarÄ±n orijinalliÄŸini kanÄ±tlayabilirsin. OnaylÄ± eÅŸyalar EO karÅŸÄ±sÄ±nda daha deÄŸerli olur.</p>
                    <p>Paran: <span class="money">${gameState.money} â‚º</span></p>
                    <div class="item-list">
                        ${listHtml}
                    </div>
                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                </div>
            `;
        }

        window.certifyItem = function(id, fee) {
            if (gameState.money < fee) return;

            const item = gameState.inventory.find(i => i.id === id);
            gameState.money -= fee;

            // 25% Chance for Fake/Junk
            if (Math.random() < 0.25) {
                item.type = 'junk';
                item.name = item.name + " (SAHTE)";
                item.realValue = Math.floor(item.realValue * 0.01); // 1% value
                alert("EKSPERT RAPORU: Bu Ã¼rÃ¼n SAHTE Ã§Ä±ktÄ±! DeÄŸeri dÃ¼ÅŸtÃ¼.");
            }

            item.certified = true;

            updateHeader();
            renderExpert();
        };

        // --- SHOP & NEGOTIATION ---

        let negotiationState = null;
        let selectedForBulk = new Set();

        window.startShopPhase = function() {
            selectedForBulk.clear();
            renderShop();
        };

        function toggleBulkSelection(id) {
            if (selectedForBulk.has(id)) selectedForBulk.delete(id);
            else selectedForBulk.add(id);
            renderShop(); // Re-render to update buttons state if needed
        }

        window.sellBulk = function() {
            if (selectedForBulk.size === 0) return;

            let totalValue = 0;
            const itemsToSell = [];

            gameState.inventory.forEach(item => {
                if(selectedForBulk.has(item.id)) {
                    // Bulk price is 60% of base estimate (approx realValue * 0.6)
                    totalValue += Math.floor(item.realValue * 0.6);
                    itemsToSell.push(item.id);
                }
            });

            if (confirm(`${itemsToSell.length} adet eÅŸyayÄ± toplam ${totalValue} â‚º karÅŸÄ±lÄ±ÄŸÄ±nda satmak istiyor musun?`)) {
                gameState.money += totalValue;
                gameState.inventory = gameState.inventory.filter(i => !selectedForBulk.has(i.id));
                selectedForBulk.clear();
                updateHeader();
                renderShop();
            }
        };

        function renderShop() {
            // If inventory empty, suggest leaving
            if (gameState.inventory.length === 0) {
                ui.app.innerHTML = `
                    <div class="screen screen-glass">
                        <h2>ğŸª DÃœKKAN BOÅ</h2>
                        <p>Satacak bir ÅŸeyin kalmadÄ±.</p>
                        <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                    </div>
                `;
                return;
            }

            if (negotiationState) {
                renderNegotiation();
                return;
            }

            const listHtml = gameState.inventory.map(item => {
                let rarityInfo = Object.values(RARITY).find(r => r.id === item.type);
                const isSelected = selectedForBulk.has(item.id);

                return `
                <div class="item-row rarity-${item.type}">
                    <div style="display:flex; align-items:center; gap:10px;">
                        <input type="checkbox" onchange="toggleBulkSelection(${item.id})" ${isSelected ? 'checked' : ''}>
                        <div>
                            <strong>${item.name}</strong> ${item.certified ? '<span class="certified-badge">ONAYLI</span>' : ''}<br>
                            <span style="color:${rarityInfo.color}; font-size:0.8rem">${rarityInfo.label}</span>
                        </div>
                    </div>
                    <button class="btn" style="font-size:0.8rem" onclick="initNegotiation(${item.id})">SAT ğŸ’°</button>
                </div>
                `;
            }).join('');

            const bulkCount = selectedForBulk.size;

            ui.app.innerHTML = `
                <div class="screen screen-glass">
                    <h2>ğŸª EO'NUN DÃœKKANI</h2>
                    <p>EO: "${EO_AI.getLine('greeting', gameState.reputation)}"</p>
                    <div style="text-align:right; margin-bottom:10px;">
                        <button class="btn btn-purple" onclick="sellBulk()" ${bulkCount === 0 ? 'disabled' : ''}>
                            ğŸ—‘ï¸ SEÃ‡Ä°LENLERÄ° TOPLU SAT (%60)
                        </button>
                    </div>
                    <div class="item-list">
                        ${listHtml}
                    </div>
                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                </div>
            `;
        }

        window.initNegotiation = function(itemId) {
            const item = gameState.inventory.find(i => i.id === itemId);

            // Check Memory and handle "Return with Certificate" logic
            let mem = gameState.negotiationMemory[itemId];

            // Special case: Player certified the item AFTER a failed negotiation
            // Logic: Memory exists, was NOT certified in memory, but IS certified now
            if (mem && !mem.wasCertified && item.certified) {
                 // Reset memory for this item effectively to allow re-pricing
                 delete gameState.negotiationMemory[itemId];
                 mem = null;
            }

            if (mem) {
                negotiationState = {
                    item: item,
                    currentOffer: mem.offer,
                    status: 'active',
                    dialogue: mem.dialogue || "KaldÄ±ÄŸÄ±mÄ±z yerden devam edelim."
                };
            } else {
                // Determine dialogue tone based on reputation
                let repTier = 'neutral';
                if (gameState.reputation > 70) repTier = 'friendly';
                else if (gameState.reputation < 30) repTier = 'suspicious';

                // --- EXPERT CONSULTATION TRIGGER ---
                let isConsulting = false;
                let consultChance = 0.3; // Default Neutral
                if (repTier === 'friendly') consultChance = 0.1;
                else if (repTier === 'suspicious') consultChance = 0.6;

                if (Math.random() < consultChance) {
                    isConsulting = true;
                }
                // -----------------------------------

                let initialOffer = EO_AI.calculateOffer(item.realValue, gameState.reputation);
                let startDialogue = EO_AI.getLine('inspecting', gameState.reputation);

                // Logic for rare/uncertified items
                if ((item.type === 'rare' || item.type === 'legendary') && !item.certified) {
                    // Suspicion Check logic
                    let suspicionChance = 0.8; // Base 80%
                    if (gameState.reputation > 70) suspicionChance = 0.2; // 20% for Friends
                    if (gameState.reputation > 90) suspicionChance = 0.05; // 5% for Partners

                    if (Math.random() < suspicionChance) {
                        // SUSPICIOUS: Lowball hard
                        initialOffer = Math.floor(initialOffer * 0.3);
                        if(repTier === 'friendly') {
                            startDialogue = "Dostum bu Ã§ok deÄŸerli gÃ¶rÃ¼nÃ¼yor ama sahteleri Ã§ok. Bir belgen var mÄ±?";
                        } else if (repTier === 'suspicious') {
                             startDialogue = "Bunu Ã§aldÄ±n mÄ±? Belgesiz hiÃ§bir ÅŸey almam, ya da hurda parasÄ±na alÄ±rÄ±m.";
                        } else {
                            startDialogue = "Bu ne? Sahte gibi duruyor. KanÄ±tÄ±n var mÄ±? Yoksa sana ancak Ã§Ã¶p parasÄ± veririm.";
                        }
                    } else {
                        // TRUSTED: Treat as if certified (better offer, normal dialogue)
                        // Slightly reduce offer compared to certified but much better than lowball
                        initialOffer = Math.floor(item.realValue * (0.6 + Math.random() * 0.2));

                        if(repTier === 'friendly') {
                            startDialogue = "GÃ¼zel parÃ§a! Senden geldiÄŸi iÃ§in orijinalliÄŸine gÃ¼veniyorum.";
                        } else {
                            startDialogue = "Riskli bir parÃ§a ama sana gÃ¼veneceÄŸim. FiyatÄ±m bu.";
                        }
                    }
                } else if (item.certified) {
                     initialOffer = Math.floor(initialOffer * 1.5); // Better offer

                     // Check if this is a "Return with Certificate" moment
                     // We know it is because we cleared 'mem' above if it was a return.
                     // But we want specific dialogue if it's a return.
                     // A simple heuristic: If the offer is much higher than what it would be uncertified.
                     // Better: Just check if we had memory before we cleared it? No, too late.
                     // Let's rely on standard certified lines, OR add a flag.

                     if (gameState.negotiationMemory[itemId] === undefined) {
                         // It could be a fresh item OR a cleared memory item.
                         // We can't easily distinguish without more state.
                         // But we can say "BelgeletmiÅŸsin" generally if it is certified.

                         if(repTier === 'friendly') {
                             startDialogue = "BelgeletmiÅŸsin! Ä°ÅŸte ÅŸimdi ciddileÅŸebiliriz dostum.";
                         } else {
                             startDialogue = "BelgeletmiÅŸsin, ÅŸimdi ciddileÅŸebiliriz.";
                         }
                     }
                }

                // If consulting, override dialogue
                if (isConsulting) {
                     const lines = EO_AI.dialogue.consulting_start[repTier];
                     const rawLine = lines[Math.floor(Math.random() * lines.length)];
                     startDialogue = rawLine.replace("${itemName}", item.name);
                }

                negotiationState = {
                    item: item,
                    currentOffer: initialOffer,
                    status: 'active', // active, sold, failed
                    lastMove: 'start',
                    dialogue: startDialogue,
                    isConsulting: isConsulting
                };

                // Save immediately
                saveNegotiationState();

                // Handle the timer if consulting
                if (isConsulting) {
                    setTimeout(() => {
                         // Check if we are still negotiating the same item
                         if(negotiationState && negotiationState.item.id === item.id && negotiationState.isConsulting) {
                             negotiationState.isConsulting = false;
                             negotiationState.dialogue = EO_AI.getLine('consulting_end', gameState.reputation);
                             
                             // Update memory to reflect we returned
                             saveNegotiationState();
                             renderNegotiation();
                         }
                    }, 5000);
                }
            }

            renderNegotiation();
        };

        function saveNegotiationState() {
            if (negotiationState && negotiationState.item) {
                gameState.negotiationMemory[negotiationState.item.id] = {
                    offer: negotiationState.currentOffer,
                    dialogue: negotiationState.dialogue,
                    wasCertified: negotiationState.item.certified // Store this to detect changes later
                };
            }
        }

        function renderNegotiation() {
            const state = negotiationState;
            const item = state.item;
            const rarityInfo = Object.values(RARITY).find(r => r.id === item.type);
            const playerKnowsValue = item.certified;

            // Check consulting state
            const isConsulting = state.isConsulting;

            // Patience Visualization
            let patienceHtml = '';
            for(let i=0; i<4; i++) {
                patienceHtml += (i < gameState.eoPatience) ? 'ğŸ”´ ' : 'âšª ';
            }

            const patienceLow = gameState.eoPatience <= 0;

            ui.app.innerHTML = `
                <div class="screen screen-glass" style="max-width:1000px; padding:0;">
                    <div class="scene-container">
                        <div class="scene-overlay"></div>
                        <div class="eo-avatar-container">
                             ${isConsulting 
                                ? `<div style="height:120px; display:flex; align-items:center; justify-content:center; color:#ccc; font-style:italic; font-size:1.2rem; text-shadow:0 0 10px rgba(0,0,0,0.8);">(Uzman aranÄ±yor...)</div>` 
                                : `<div class="eo-avatar">ğŸ‘º</div>`
                             }
                             <div class="speech-bubble">"${state.dialogue}"</div>
                             <div style="margin-top:10px; font-size:1.2rem; background:rgba(0,0,0,0.5); padding:5px 10px; border-radius:10px;">
                                SABIR: ${patienceHtml}
                             </div>
                        </div>

                        <div class="negotiation-desk">
                            <div class="desk-item">
                                <h3 style="margin:0; color:var(--accent-color)">${item.name}</h3>
                                <div style="font-size:0.8rem; opacity:0.8">${rarityInfo.label} ${item.certified ? 'âœ…' : ''}</div>
                                <div style="margin-top:5px; font-weight:bold; color:var(--success-color)">TEKLÄ°F: ${state.currentOffer} â‚º</div>
                                ${playerKnowsValue ? `<div style="font-size:0.7rem; color:#aaa">GerÃ§ek DeÄŸer: ${item.realValue} â‚º</div>` : ''}
                            </div>

                            <div class="desk-actions">
                                <button class="btn" onclick="actionAccept()" ${isConsulting ? 'disabled' : ''}>âœ… KABUL (${state.currentOffer} â‚º)</button>
                                <button class="btn" onclick="showCounterInput()" ${patienceLow || isConsulting ? 'disabled' : ''}>ğŸ’¬ PAZARLIK</button>
                                <button class="btn btn-purple" onclick="actionBluff()" ${patienceLow || isConsulting ? 'disabled' : ''}>ğŸ² BLÃ–F</button>
                                <button class="btn btn-danger" onclick="actionThreaten()" ${patienceLow || isConsulting ? 'disabled' : ''}>ğŸ¤¬ TEHDÄ°T</button>
                                <button class="btn" style="background:transparent; border:1px solid #555;" onclick="actionCancel()" ${isConsulting ? 'disabled' : ''}>âŒ VAZGEÃ‡</button>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        window.actionAccept = function() {
            // Sell item
            gameState.money += negotiationState.currentOffer;

            // Remove item
            gameState.inventory = gameState.inventory.filter(i => i.id !== negotiationState.item.id);
            // Clear from memory as it's sold
            if (gameState.negotiationMemory[negotiationState.item.id]) {
                delete gameState.negotiationMemory[negotiationState.item.id];
            }

            // Reputation small boost for easy deal
            changeReputation(1);

            negotiationState = null;
            updateHeader();
            renderShop();
        };

        window.actionCancel = function() {
            saveNegotiationState();
            negotiationState = null;
            renderShop();
        };

        window.showCounterInput = function() {
            const currentOffer = negotiationState.currentOffer;
            const promptAmount = prompt("KarÅŸÄ± teklifin nedir? (Sadece sayÄ±)", currentOffer);
            if (promptAmount) {
                const val = parseInt(promptAmount);
                if (!isNaN(val)) {
                    processCounterOffer(val);
                }
            }
        };

        function processCounterOffer(playerOffer) {
            const state = negotiationState;
            const item = state.item;
            const realValue = item.realValue;

            // Logic: Is the offer reasonable?
            let repBonus = (gameState.reputation - 50) / 100; // -0.5 to 0.5
            let maxTolerable = realValue * (1.0 + repBonus);

            // Certification Logic: If rare/legendary and NOT certified, he won't pay near full value
            // unless forced or convinced.
            if ((item.type === 'rare' || item.type === 'legendary') && !item.certified) {
                // If Friendly, he is slightly more lenient
                if (gameState.reputation > 70) maxTolerable = realValue * 0.65;
                else maxTolerable = realValue * 0.5;
            }

            // Hidden Interest Mechanic
            if (item.eoInterest === 2) {
                // He really wants it, so he will tolerate higher prices eventually
                maxTolerable *= 1.5;
            } else if (item.eoInterest === 1) {
                maxTolerable *= 1.2;
            }

            if (playerOffer <= state.currentOffer) {
                state.dialogue = "Daha dÃ¼ÅŸÃ¼k teklif mi? Kafan mÄ± gÃ¼zel? Neyse, kabul.";
                state.currentOffer = playerOffer;
                renderNegotiation();
                return;
            }

            if (playerOffer <= maxTolerable) {
                // Success chance based on how greedy the player is
                const greedFactor = playerOffer / realValue; // 1.0 = fair, 1.2 = pushing it
                // Friend bonus: easier to convince
                let successChanceModifier = (gameState.reputation - 50) / 200; // +/- 0.25

                const roll = Math.random();

                if (roll > (greedFactor - 0.5 - successChanceModifier)) {
                    // Accepted
                    state.currentOffer = playerOffer;

                    if (item.eoInterest === 2) {
                         state.dialogue = "Tamam tamam, alÄ±yorum. SakÄ±n kimseye bu fiyattan bahsetme.";
                    } else {
                         state.dialogue = EO_AI.getLine('accept', gameState.reputation);
                    }
                } else {
                    // Counter-counter
                    const middleGround = Math.floor((state.currentOffer + playerOffer) / 2);
                    state.currentOffer = middleGround;
                    state.dialogue = EO_AI.getLine('lowball', gameState.reputation);
                    gameState.eoPatience -= 1;
                }
            } else {
                // Insultingly high
                state.dialogue = EO_AI.getLine('reject', gameState.reputation);
                gameState.eoPatience -= 1;
            }

            saveNegotiationState();
            checkPatience();
            renderNegotiation();
        }

        window.actionBluff = function() {
            const state = negotiationState;
            // Bluff mechanics: Try to increase perceived value
            const roll = Math.random();
            const successChance = 0.4 + (gameState.reputation / 200);

            if (roll < successChance) {
                // Success
                state.currentOffer = Math.floor(state.currentOffer * 1.5);
                state.dialogue = "Hmm... GerÃ§ekten mi? Bak bunu fark etmemiÅŸtim. FiyatÄ± arttÄ±rÄ±yorum.";
            } else {
                // Fail
                state.dialogue = "Kimi kandÄ±rÄ±yorsun sen? Bu numara bana sÃ¶kmez.";
                gameState.eoPatience -= 2;
                changeReputation(-5);
            }
            saveNegotiationState();
            checkPatience();
            renderNegotiation();
        };

        window.actionThreaten = function() {
            const state = negotiationState;
            // High risk
            const roll = Math.random();
            if (roll > 0.7) {
                // Success: Force max value
                state.currentOffer = Math.floor(state.item.realValue * 1.2);
                state.dialogue = EO_AI.getLine('threatResponse');
                changeReputation(-10); // Reputation hit even if successful
            } else {
                // Fail: EO ends negotiation
                state.dialogue = "Defol dÃ¼kkanÄ±mdan!";
                gameState.eoPatience = 0;
            }
            saveNegotiationState();
            checkPatience();
            renderNegotiation();
        };

        function checkPatience() {
            if (gameState.eoPatience <= 0) {
                // Force sell at low price or kick out?
                // For now, let's say he forces the last offer or kicks out.
                // Let's make him withdraw the offer and offer a pity amount (scrap value).
                negotiationState.dialogue = "SabrÄ±mÄ± taÅŸÄ±rdÄ±n. Ya bu fiyata alÄ±rsÄ±n ya da defolursun.";
                // Don't nuke the offer completely to 0, just leave it as last offer, but he refuses to negotiate more.
                // Reverting logic: "eÅŸyalara verdiÄŸi son teklifi ... sÄ±fÄ±rlanmasÄ±n"
                // But if he gets angry, does he lower it?
                // The prompt says: "eÅŸyalara verdiÄŸi son teklifi ve sabrÄ± vazgeÃ§ tuÅŸuna tÄ±klayÄ±nca sÄ±fÄ±rlanmasÄ±n"
                // It doesn't explicitly say we can't lower it on failed negotiations.
                // But usually "SabrÄ±mÄ± taÅŸÄ±rdÄ±n" means take it or leave it.
                // I will keep the current offer but prevent further actions (handled in renderNegotiation via disabled buttons).
            }
        }

        // --- HELPERS ---
        function changeReputation(amount) {
            gameState.reputation = Math.min(100, Math.max(0, gameState.reputation + amount));
        }

        function finishRound() {
            gameState.round++;
            gameState.availableUnits = [];
            ui.app.innerHTML = `
                <div class="screen">
                    <h2>TUR TAMAMLANDI</h2>
                    <p>BugÃ¼nkÃ¼ hasÄ±latÄ± topladÄ±n.</p>
                    <p class="money" style="font-size:2rem">${gameState.money} â‚º</p>
                    <button class="btn" onclick="startRound()">SONRAKÄ° TUR</button>
                </div>
            `;
            updateHeader();
        }

        window.buyUnit = function(id) {
            const unit = gameState.availableUnits.find(u => u.id === id);
            if(gameState.money < unit.price) return;

            gameState.money -= unit.price;
            gameState.currentUnit = unit;
            updateHeader();

            // Generate items
            const newItems = generateItemsForUnit(unit);
            gameState.inventory.push(...newItems);

            revealItems(newItems);
        };

        function generateItemsForUnit(unit) {
            const itemCount = 3 + Math.floor(Math.random() * 3); // 3-5 items
            const items = [];

            for(let i=0; i<itemCount; i++) {
                // Determine rarity based on risk
                let roll = Math.random();
                let chosenType = 'junk';

                if (unit.risk === 3) { // Black Market: High Risk / High Reward
                    // 40% Junk, 30% Rare, 30% Legendary
                    if (roll < 0.40) chosenType = 'junk';
                    else if (roll < 0.70) chosenType = 'rare';
                    else chosenType = 'legendary';
                } else if (unit.risk === 0) { // Low Risk: Mostly Common (0.4-0.95), some Junk (<0.4), rare Rare (>0.95)
                    if (roll < 0.40) chosenType = 'junk';
                    else if (roll < 0.95) chosenType = 'common';
                    else chosenType = 'rare'; // 5% Rare, 0% Legendary
                } else if (unit.risk === 1) { // Med Risk: Balanced
                    if (roll < 0.30) chosenType = 'junk';
                    else if (roll < 0.85) chosenType = 'common';
                    else if (roll < 0.985) chosenType = 'rare'; // 13.5% Rare
                    else chosenType = 'legendary'; // 1.5% Legendary (Very rare)
                } else { // High Risk: High Junk, but potential for Rare/Legendary
                    if (roll < 0.50) chosenType = 'junk'; // 50% Junk
                    else if (roll < 0.85) chosenType = 'common'; // 35% Common
                    else if (roll < 0.98) chosenType = 'rare'; // 13% Rare
                    else chosenType = 'legendary'; // 2% Legendary
                }

                const possibleItems = ITEMS_DB.filter(x => x.type === chosenType);
                const template = possibleItems[Math.floor(Math.random() * possibleItems.length)];

                // Variation in value
                const valueVariation = 0.8 + (Math.random() * 0.4); // +/- 20%
                const finalValue = Math.floor(template.baseValue * valueVariation);

                items.push({
                    ...template,
                    realValue: finalValue,
                    eoInterest: Math.random() > 0.8 ? 2 : (Math.random() > 0.5 ? 1 : 0), // 0=None, 1=Mild, 2=High
                    id: Date.now() + i
                });
            }
            return items;
        }

        function revealItems(newItems) {
            const listHtml = newItems.map(item => {
                let rarityInfo = Object.values(RARITY).find(r => r.id === item.type);
                return `
                <div class="item-row rarity-${item.type}">
                    <div>
                        <strong>${item.name}</strong><br>
                        <span style="color:${rarityInfo.color}; font-size:0.8rem">${rarityInfo.label}</span>
                    </div>
                    <div style="display:flex; align-items:center;">
                        <span style="color:#888; font-size:0.9rem">Tahmini: ???</span>
                    </div>
                </div>
                `;
            }).join('');

            ui.app.innerHTML = `
                <div class="screen">
                    <h2>DEPODAN Ã‡IKANLAR</h2>
                    <div class="item-list">
                        ${listHtml}
                    </div>
                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHÄ°R MERKEZÄ°NE GÄ°T</button>
                </div>
            `;
        }

        // --- WORKSHOP SYSTEM ---
        window.startWorkshopPhase = function() {
            renderWorkshop();
        };

        function renderWorkshop() {
            const junkItems = gameState.inventory.filter(i => i.type === 'junk');
            const repairCost = 200;
            const canAfford = gameState.money >= repairCost;

            // Restorer Skill Chance
            const skillLevel = gameState.skills.restorer || 0;
            const successChance = Math.min(0.9, 0.3 + (skillLevel * 0.15));

            const listHtml = junkItems.map(item => `
                <div class="item-row rarity-junk">
                    <div>
                        <strong>${item.name}</strong><br>
                        <span style="color:#9e9e9e; font-size:0.8rem">Hurda</span>
                    </div>
                    <button class="btn" onclick="repairItem(${item.id})" ${!canAfford ? 'disabled' : ''}>
                        ğŸ”¨ ONAR (${repairCost}â‚º) %${Math.round(successChance * 100)}
                    </button>
                </div>
            `).join('');

            ui.app.innerHTML = `
                <div class="screen screen-glass">
                    <h2>ğŸ› ï¸ ATÃ–LYE</h2>
                    <p>Hurda eÅŸyalarÄ± onarmayÄ± dene. BaÅŸarÄ±sÄ±z olursan eÅŸya yok olur!</p>
                    <p>Paran: <span class="money">${gameState.money} â‚º</span></p>

                    ${junkItems.length === 0 ? '<p>OnarÄ±lacak hurda yok.</p>' : `<div class="item-list">${listHtml}</div>`}

                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                </div>
            `;
        }

        window.repairItem = function(itemId) {
            if (gameState.money < 200) return;
            gameState.money -= 200;

            const itemIndex = gameState.inventory.findIndex(i => i.id === itemId);
            if (itemIndex === -1) return;
            const item = gameState.inventory[itemIndex];

            // Success Check
            const skillLevel = gameState.skills.restorer || 0;
            const successChance = Math.min(0.9, 0.3 + (skillLevel * 0.15));

            if (Math.random() < successChance) {
                // Success! Convert to Common or Rare
                const isRare = Math.random() < 0.3; // 30% chance for Rare upgrade
                const newType = isRare ? 'rare' : 'common';

                // Update Item
                item.type = newType;
                item.name = item.name.replace(' (Hurda)', '').replace('KÄ±rÄ±k ', 'OnarÄ±lmÄ±ÅŸ ').replace('Bozuk ', 'Tamir EdilmiÅŸ ');
                if (!item.name.includes('OnarÄ±lmÄ±ÅŸ') && !item.name.includes('Tamir EdilmiÅŸ')) {
                    item.name = "OnarÄ±lmÄ±ÅŸ " + item.name;
                }

                // Update Value
                const baseVal = isRare ? 5000 : 500;
                item.realValue = Math.floor(baseVal * (0.8 + Math.random() * 0.4));
                item.certified = false; // Reset certification

                alert(`ğŸ‰ BAÅARILI! EÅŸya onarÄ±ldÄ±: ${item.name}`);
            } else {
                // Fail - Destroy
                gameState.inventory.splice(itemIndex, 1);
                alert("ğŸ’¥ BAÅARISIZ! EÅŸya parÃ§alarÄ±na ayrÄ±ldÄ± ve yok oldu.");
            }
            updateHeader();
            renderWorkshop();
        };

        // --- SKILL SYSTEM ---
        window.startSkillsPhase = function() {
            renderSkills();
        };

        function renderSkills() {
            const skillHtml = Object.values(SKILLS_CONFIG).map(skill => {
                const currentLvl = gameState.skills[skill.id] || 0;
                const canUpgrade = currentLvl < skill.maxLevel && gameState.skillPoints >= skill.cost;

                return `
                <div class="item-row" style="background:rgba(255,255,255,0.05); flex-direction:column; align-items:flex-start; gap:10px;">
                    <div style="width:100%; display:flex; justify-content:space-between; align-items:center;">
                        <div>
                            <strong style="font-size:1.1rem; color:var(--accent-color)">${skill.name}</strong>
                            <span style="font-size:0.8rem; margin-left:10px; background:#333; padding:2px 6px; border-radius:4px;">Lvl ${currentLvl}/${skill.maxLevel}</span>
                        </div>
                        <button class="btn btn-purple" onclick="purchaseSkill('${skill.id}')" ${!canUpgrade ? 'disabled' : ''}>
                            ${currentLvl >= skill.maxLevel ? 'MAX' : `YÃœKSELT (${skill.cost} Puan)`}
                        </button>
                    </div>
                    <p style="margin:0; opacity:0.8; font-size:0.9rem">${skill.desc}</p>
                </div>
                `;
            }).join('');

            ui.app.innerHTML = `
                <div class="screen screen-glass">
                    <h2>ğŸ§  YETENEKLER</h2>
                    <p>Seviye atlayarak yetenek puanÄ± kazan.</p>
                    <p>Mevcut Puan: <span style="color:var(--accent-color); font-weight:bold; font-size:1.5rem;">${gameState.skillPoints}</span></p>

                    <div class="item-list">
                        ${skillHtml}
                    </div>

                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                </div>
            `;
        }

        window.purchaseSkill = function(skillId) {
            const skill = SKILLS_CONFIG[skillId];
            if (!skill) return;
            const currentLvl = gameState.skills[skillId] || 0;

            if (currentLvl < skill.maxLevel && gameState.skillPoints >= skill.cost) {
                gameState.skillPoints -= skill.cost;
                gameState.skills[skillId]++;

                // Immediate Effects
                if (skillId === 'hoarder') {
                    gameState.inventoryLimit += 5;
                    alert("Depo kapasitesi artÄ±rÄ±ldÄ±!");
                }

                renderSkills();
            }
        };

        // --- WAREHOUSE SYSTEM ---
        window.startWarehousePhase = function() {
            renderWarehouse();
        };

        function renderWarehouse() {
            const upgradeCost = 5000 * gameState.storageLevel;
            const canAfford = gameState.money >= upgradeCost;

            const listHtml = gameState.inventory.map(item => {
                let rarityInfo = Object.values(RARITY).find(r => r.id === item.type);
                return `
                <div class="item-row rarity-${item.type}" style="padding:10px;">
                    <div style="font-size:0.9rem">
                        <strong>${item.name}</strong> (${rarityInfo.label})
                    </div>
                    <div style="font-size:0.8rem; color:#aaa;">
                        ${item.certified ? `DeÄŸer: ${item.realValue} â‚º` : 'DeÄŸer: ???'}
                    </div>
                </div>
                `;
            }).join('');

            ui.app.innerHTML = `
                <div class="screen screen-glass">
                    <h2>ğŸ“¦ DEPO YÃ–NETÄ°MÄ°</h2>
                    <div style="display:flex; justify-content:space-around; margin:20px 0;">
                        <div>
                            <div class="stat-label">KAPASÄ°TE</div>
                            <div style="font-size:1.5rem">${gameState.inventory.length} / ${gameState.inventoryLimit}</div>
                        </div>
                        <div>
                            <div class="stat-label">GÃœNLÃœK KÄ°RA</div>
                            <div style="font-size:1.5rem; color:var(--danger-color)">${gameState.inventory.length * 50} â‚º</div>
                        </div>
                    </div>

                    <button class="btn btn-purple" onclick="upgradeStorage()" ${!canAfford ? 'disabled' : ''}>
                        â¬†ï¸ DEPOYU BÃœYÃœT (+5 Yer) - ${upgradeCost} â‚º
                    </button>

                    <h3 style="margin-top:30px; text-align:left;">Envanter</h3>
                    <div class="item-list" style="max-height:300px; overflow-y:auto;">
                        ${listHtml}
                    </div>

                    <button class="btn" onclick="startHubPhase()">ğŸ™ï¸ ÅEHRE DÃ–N</button>
                </div>
            `;
        }

        window.upgradeStorage = function() {
            const upgradeCost = 5000 * gameState.storageLevel;
            if (gameState.money >= upgradeCost) {
                gameState.money -= upgradeCost;
                gameState.inventoryLimit += 5;
                gameState.storageLevel++;
                alert("Depo bÃ¼yÃ¼tÃ¼ldÃ¼! Yeni kapasite: " + gameState.inventoryLimit);
                updateHeader();
                renderWarehouse();
            }
        };

        window.startHubPhase = function() {
            renderHub();
        };

        function renderHub() {
             // Quest Display
             const questsHtml = gameState.quests.map(q =>
                 `<div style="font-size:0.85rem; background:rgba(255,255,255,0.05); padding:8px; border-radius:5px; margin-bottom:5px; text-align:left; border-left:3px solid ${q.completed ? 'var(--success-color)' : 'var(--accent-color)'}">
                    ${q.completed ? 'âœ…' : 'ğŸ“œ'} ${q.text} (${q.current}/${q.count})
                 </div>`
             ).join('');

             ui.app.innerHTML = `
                <div class="screen">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <h2>ğŸ™ï¸ ÅEHÄ°R MERKEZÄ°</h2>
                        <div style="text-align:right;">
                            <span style="font-size:0.9rem; color:var(--accent-color)">Seviye ${gameState.level}</span><br>
                            <span style="font-size:0.8rem; opacity:0.7">${gameState.xp}/${gameState.level * 1000} XP</span>
                        </div>
                    </div>

                    ${gameState.quests.length > 0 ? `
                        <div style="margin-bottom:20px;">
                            <h4 style="margin:5px 0; text-align:left; opacity:0.8;">GÃœNLÃœK GÃ–REVLER</h4>
                            ${questsHtml}
                        </div>
                    ` : ''}

                    <div class="hub-menu">
                        <div class="hub-card" onclick="renderStorageSelection()">
                            <div class="hub-icon">ğŸ“¢</div>
                            <div class="hub-title">Ä°hale AlanÄ±</div>
                            <div>Kalan depolarÄ± incele ve satÄ±n al.</div>
                        </div>

                        <div class="hub-card" onclick="startShopPhase()">
                            <div class="hub-icon">ğŸª</div>
                            <div class="hub-title">EO'nun DÃ¼kkanÄ±</div>
                            <div>EÅŸyalarÄ± sat ve pazarlÄ±k yap.</div>
                        </div>

                        <div class="hub-card" onclick="startExpertPhase()">
                            <div class="hub-icon">ğŸ§</div>
                            <div class="hub-title">Ekspertiz</div>
                            <div>EÅŸyalarÄ± onaylat ve deÄŸerini Ã¶ÄŸren.</div>
                        </div>

                        <div class="hub-card" onclick="startWorkshopPhase()">
                            <div class="hub-icon">ğŸ› ï¸</div>
                            <div class="hub-title">AtÃ¶lye</div>
                            <div>Hurda eÅŸyalarÄ± onar.</div>
                        </div>

                        <div class="hub-card" onclick="startSkillsPhase()">
                            <div class="hub-icon">ğŸ§ </div>
                            <div class="hub-title">Yetenekler</div>
                            <div>Karakterini geliÅŸtir.</div>
                        </div>

                        <div class="hub-card" onclick="startWarehousePhase()">
                            <div class="hub-icon">ğŸ“¦</div>
                            <div class="hub-title">Depo</div>
                            <div>Envanterini yÃ¶net.</div>
                        </div>

                        <div class="hub-card" onclick="finishRound()" style="border-color:var(--success-color)">
                            <div class="hub-icon">ğŸ’¤</div>
                            <div class="hub-title">GÃ¼nÃ¼ Bitir</div>
                            <div>Sonraki tura geÃ§.</div>
                        </div>
                    </div>
                </div>
            `;
        }

    </script>
</body>
</html>
